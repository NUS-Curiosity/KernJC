configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E8618AFC-8179-4431-9436-5CE1FBD9B32F
      versionEndExcluding: 4.17.2
      vulnerable: true
    negate: false
    operator: OR
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
      matchCriteriaId: F7016A2A-8365-4F1A-89A2-7A19F2BCAE5B
      vulnerable: true
    - criteria: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
      matchCriteriaId: 23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: In arch/x86/kvm/vmx.c in the Linux kernel before 4.17.2, when nested virtualization
    is used, local attackers could cause L1 KVM guests to VMEXIT, potentially allowing
    privilege escalations and denial of service attacks due to lack of checking of
    CPL.
- lang: es
  value: "En arch/x86/kvm/vmx.c en el kernel de Linux en versiones anteriores a la\
    \ 4.17.2, cuando se emplea la virtualizaci\xF3n anidada, los atacantes locales\
    \ podr\xEDan hacer que los invitados L1 KVM realizasen un VMEXIT, permitiendo\
    \ escalados de privilegios y ataques de denegaci\xF3n de servicio (DoS) debido\
    \ a la falta de comprobaci\xF3n de CPL."
id: CVE-2018-12904
lastModified: '2019-10-03T00:03:26.223'
metrics:
  cvssMetricV2:
  - acInsufInfo: false
    baseSeverity: MEDIUM
    cvssData:
      accessComplexity: MEDIUM
      accessVector: LOCAL
      authentication: NONE
      availabilityImpact: PARTIAL
      baseScore: 4.4
      confidentialityImpact: PARTIAL
      integrityImpact: PARTIAL
      vectorString: AV:L/AC:M/Au:N/C:P/I:P/A:P
      version: '2.0'
    exploitabilityScore: 3.4
    impactScore: 6.4
    obtainAllPrivilege: false
    obtainOtherPrivilege: false
    obtainUserPrivilege: false
    source: nvd@nist.gov
    type: Primary
    userInteractionRequired: false
  cvssMetricV30:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: LOW
      baseScore: 4.9
      baseSeverity: MEDIUM
      confidentialityImpact: LOW
      integrityImpact: LOW
      privilegesRequired: NONE
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
      version: '3.0'
    exploitabilityScore: 1.4
    impactScore: 3.4
    source: nvd@nist.gov
    type: Primary
published: '2018-06-27T11:29:00.237'
references:
- source: cve@mitre.org
  tags:
  - Patch
  - Vendor Advisory
  url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8
- source: cve@mitre.org
  tags:
  - Exploit
  - Third Party Advisory
  url: https://bugs.chromium.org/p/project-zero/issues/detail?id=1589
- source: cve@mitre.org
  tags:
  - Release Notes
  - Vendor Advisory
  url: https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.17.2
- source: cve@mitre.org
  tags:
  - Patch
  - Third Party Advisory
  url: https://github.com/torvalds/linux/commit/727ba748e110b4de50d142edca9d6a9b7e6111d8
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://usn.ubuntu.com/3752-1/
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://usn.ubuntu.com/3752-2/
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://usn.ubuntu.com/3752-3/
- source: cve@mitre.org
  tags:
  - Exploit
  - Third Party Advisory
  - VDB Entry
  url: https://www.exploit-db.com/exploits/44944/
sourceIdentifier: cve@mitre.org
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: NVD-CWE-noinfo
  source: nvd@nist.gov
  type: Primary
