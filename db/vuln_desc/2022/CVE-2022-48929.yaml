configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: BEB734DF-768A-48DC-8983-4ED1A0CA1A3D
      versionEndExcluding: 5.15.37
      versionStartIncluding: 5.15.15
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 4368C931-8568-4F36-A74D-8E41781257A6
      versionEndExcluding: 5.16.12
      versionStartIncluding: 5.16.1
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    bpf: Fix crash due to out of bounds access into reg2btf_ids.


    When commit e6ac2450d6de ("bpf: Support bpf program calling kernel function")
    added

    kfunc support, it defined reg2btf_ids as a cheap way to translate the verifier

    reg type to the appropriate btf_vmlinux BTF ID, however

    commit c25b2ae13603 ("bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL")

    moved the __BPF_REG_TYPE_MAX from the last member of bpf_reg_type enum to after

    the base register types, and defined other variants using type flag

    composition. However, now, the direct usage of reg->type to index into

    reg2btf_ids may no longer fall into __BPF_REG_TYPE_MAX range, and hence lead to

    out of bounds access and kernel crash on dereference of bad pointer.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: bpf:\
    \ Se corrigi\xF3 el bloqueo debido al acceso fuera de los l\xEDmites a reg2btf_ids.\
    \ Cuando el commit e6ac2450d6de (\"bpf: admite la funci\xF3n del kernel que llama\
    \ al programa bpf\") agreg\xF3 soporte para kfunc, defini\xF3 reg2btf_ids como\
    \ una forma econ\xF3mica de traducir el tipo de registro del verificador al ID\
    \ de BTF btf_vmlinux apropiado; sin embargo, commit c25b2ae13603 (\"bpf: reemplace\
    \ PTR_TO_XXX_OR_NULL con PTR_TO_XXX | PTR_MAYBE_NULL\") movi\xF3 __BPF_REG_TYPE_MAX\
    \ del \xFAltimo miembro de la enumeraci\xF3n bpf_reg_type a despu\xE9s de los\
    \ tipos de registro base y defini\xF3 otras variantes utilizando la composici\xF3\
    n de indicadores de tipo. Sin embargo, ahora, el uso directo de reg-&gt;type para\
    \ indexar en reg2btf_ids ya no puede caer en el rango __BPF_REG_TYPE_MAX y, por\
    \ lo tanto, provocar un acceso fuera de los l\xEDmites y un bloqueo del kernel\
    \ al desreferenciar un puntero incorrecto."
id: CVE-2022-48929
lastModified: '2024-08-23T02:00:22.653'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-08-22T04:15:15.773'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/45ce4b4f9009102cd9f581196d480a59208690c1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8c39925e98d498b9531343066ef82ae39e41adae
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f0ce1bc9e0235dd7412240be493d7ea65ed9eadc
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-125
  source: nvd@nist.gov
  type: Primary
