configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 72C5D0FA-1645-4649-A21B-6D40B49AA943
      versionEndExcluding: 4.9.302
      versionStartIncluding: '4.3'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FD3CEBEB-60B8-4EA2-B346-6ADF49F754D9
      versionEndExcluding: 4.14.267
      versionStartIncluding: '4.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 62845903-4271-4AFA-B8B7-6517ED5BFEB2
      versionEndExcluding: 4.19.230
      versionStartIncluding: '4.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6808B38F-AD73-4D55-A158-6EF605E8EB66
      versionEndExcluding: 5.4.180
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A154171E-A3B9-42BE-9E97-C9B0EA43FC54
      versionEndExcluding: 5.10.101
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 866451F0-299E-416C-B0B8-AE6B33E62CCA
      versionEndExcluding: 5.15.24
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 679523BA-1392-404B-AB85-F5A5408B1ECC
      versionEndExcluding: 5.16.10
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    net: fix a memleak when uncloning an skb dst and its metadata


    When uncloning an skb dst and its associated metadata, a new

    dst+metadata is allocated and later replaces the old one in the skb.

    This is helpful to have a non-shared dst+metadata attached to a specific

    skb.


    The issue is the uncloned dst+metadata is initialized with a refcount of

    1, which is increased to 2 before attaching it to the skb. When

    tun_dst_unclone returns, the dst+metadata is only referenced from a

    single place (the skb) while its refcount is 2. Its refcount will never

    drop to 0 (when the skb is consumed), leading to a memory leak.


    Fix this by removing the call to dst_hold in tun_dst_unclone, as the

    dst+metadata refcount is already 1.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net:\
    \ soluciona un memleak al desaclonar un skb dst y sus metadatos Al desaclonar\
    \ un skb dst y sus metadatos asociados, se asigna un nuevo dst+metadatos que luego\
    \ reemplaza al antiguo en el skb. Esto es \xFAtil para tener metadatos dst+ no\
    \ compartidos adjuntos a un skb espec\xEDfico. El problema es que los metadatos\
    \ dst+ no clonados se inicializan con un recuento de 1, que se incrementa a 2\
    \ antes de adjuntarlo al skb. Cuando tun_dst_unclone regresa, solo se hace referencia\
    \ a los metadatos dst+ desde un \xFAnico lugar (el skb) mientras su refcount es\
    \ 2. Su refcount nunca bajar\xE1 a 0 (cuando se consume el skb), lo que provoca\
    \ una p\xE9rdida de memoria. Solucione este problema eliminando la llamada a dst_hold\
    \ en tun_dst_unclone, ya que el recuento de metadatos dst+ ya es 1."
id: CVE-2022-48809
lastModified: '2024-08-07T19:18:21.437'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-16T12:15:05.190'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/00e6d6c3bc14dfe32824e2c515f0e0f2d6ecf2f1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0be943916d781df2b652793bb2d3ae4f9624c10a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/4ac84498fbe84a00e7aef185e2bb3e40ce71eca4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8b1087b998e273f07be13dcb5f3ca4c309c7f108
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/9eeabdf17fa0ab75381045c867c370f4cc75a613
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/a80817adc2a4c1ba26a7aa5f3ed886e4a18dff88
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/c1ff27d100e2670b03cbfddb9117e5f9fc672540
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/fdcb263fa5cda15b8cb24a641fa2718c47605314
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-401
  source: nvd@nist.gov
  type: Primary
