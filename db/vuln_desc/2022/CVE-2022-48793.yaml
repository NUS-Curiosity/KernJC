configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6467CE52-5FC4-4C7B-A594-75503B1F51B0
      versionEndExcluding: 5.15.25
      versionStartIncluding: '5.13'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0D327234-5D4A-43DC-A6DF-BCA0CEBEC039
      versionEndExcluding: 5.16.11
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    KVM: x86: nSVM: fix potential NULL derefernce on nested migration


    Turns out that due to review feedback and/or rebases

    I accidentally moved the call to nested_svm_load_cr3 to be too early,

    before the NPT is enabled, which is very wrong to do.


    KVM can''t even access guest memory at that point as nested NPT

    is needed for that, and of course it won''t initialize the walk_mmu,

    which is main issue the patch was addressing.


    Fix this for real.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: KVM:\
    \ x86: nSVM: corrige una posible desreferencia NULL en la migraci\xF3n anidada\
    \ Resulta que, debido a los comentarios de revisi\xF3n y/o cambios de base, accidentalmente\
    \ mov\xED la llamada a nested_svm_load_cr3 para que fuera demasiado pronto, antes\
    \ de NPT est\xE1 habilitado, lo cual es muy incorrecto. KVM ni siquiera puede\
    \ acceder a la memoria del invitado en ese momento, ya que para eso se necesita\
    \ NPT anidado y, por supuesto, no inicializar\xE1 walk_mmu, que es el principal\
    \ problema que solucionaba el parche. Arregla esto de verdad."
id: CVE-2022-48793
lastModified: '2024-08-07T19:22:16.063'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-16T12:15:04.067'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/352193edda48e08e8824a7ece09aec830a603cfe
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/74b426bea4f7e3b081add2b88d4fba16d3af7ab6
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e1779c2714c3023e4629825762bcbc43a3b943df
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
