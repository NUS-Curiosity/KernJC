configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FE2A35CB-3560-4AEF-9643-66B8EB899366
      versionEndExcluding: 5.10.102
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D098AA16-8E21-4EB7-AE2F-1EEB58E1A3A3
      versionEndExcluding: 5.15.25
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0D327234-5D4A-43DC-A6DF-BCA0CEBEC039
      versionEndExcluding: 5.16.11
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    scsi: pm8001: Fix use-after-free for aborted TMF sas_task


    Currently a use-after-free may occur if a TMF sas_task is aborted before we

    handle the IO completion in mpi_ssp_completion(). The abort occurs due to

    timeout.


    When the timeout occurs, the SAS_TASK_STATE_ABORTED flag is set and the

    sas_task is freed in pm8001_exec_internal_tmf_task().


    However, if the I/O completion occurs later, the I/O completion still

    thinks that the sas_task is available. Fix this by clearing the ccb->task

    if the TMF times out - the I/O completion handler does nothing if this

    pointer is cleared.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: scsi:\
    \ pm8001: Correcci\xF3n de use-after-free para TMF sas_task abortada Actualmente,\
    \ puede ocurrir un use-after-free si se cancela una TMF sas_task antes de que\
    \ manejemos la finalizaci\xF3n de IO en mpi_ssp_completion( ). El aborto se produce\
    \ debido al tiempo de espera. Cuando se agota el tiempo de espera, se establece\
    \ el indicador SAS_TASK_STATE_ABORTED y sas_task se libera en pm8001_exec_internal_tmf_task().\
    \ Sin embargo, si la finalizaci\xF3n de E/S se produce m\xE1s tarde, la finalizaci\xF3\
    n de E/S todav\xEDa piensa que sas_task est\xE1 disponible. Solucione este problema\
    \ borrando la tarea ccb-&gt; si se agota el tiempo de espera del TMF; el controlador\
    \ de finalizaci\xF3n de E/S no hace nada si se borra este puntero."
id: CVE-2022-48791
lastModified: '2024-08-07T19:41:54.260'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-07-16T12:15:03.910'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3c334cdfd94945b8edb94022a0371a8665b17366
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/510b21442c3a2e3ecc071ba3e666b320e7acdd61
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/61f162aa4381845acbdc7f2be4dfb694d027c018
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d872e7b5fe38f325f5206b6872746fa02c2b4819
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
