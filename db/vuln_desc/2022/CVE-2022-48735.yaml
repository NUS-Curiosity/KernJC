configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E58D7990-F870-451F-A267-BF81F7ABEAEB
      versionEndExcluding: 5.10.99
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 74528AA6-B524-4C3F-B188-1194235FE47D
      versionEndExcluding: 5.15.22
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0623892A-E3E4-44E6-8A5E-39A0B47AF782
      versionEndExcluding: 5.16.8
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    ALSA: hda: Fix UAF of leds class devs at unbinding


    The LED class devices that are created by HD-audio codec drivers are

    registered via devm_led_classdev_register() and associated with the

    HD-audio codec device.  Unfortunately, it turned out that the devres

    release doesn''t work for this case; namely, since the codec resource

    release happens before the devm call chain, it triggers a NULL

    dereference or a UAF for a stale set_brightness_delay callback.


    For fixing the bug, this patch changes the LED class device register

    and unregister in a manual manner without devres, keeping the

    instances in hda_gen_spec.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: ALSA:\
    \ hda: corrige UAF de los desarrolladores de clase LED al desvincularse. Los dispositivos\
    \ de clase LED creados por controladores de c\xF3dec de audio HD se registran\
    \ a trav\xE9s de devm_led_classdev_register() y se asocian con el audio HD. dispositivo\
    \ c\xF3dec. Desafortunadamente, result\xF3 que la versi\xF3n devres no funciona\
    \ para este caso; es decir, dado que la liberaci\xF3n del recurso del c\xF3dec\
    \ ocurre antes de la cadena de llamadas del desarrollador, desencadena una desreferencia\
    \ NULL o un UAF para una devoluci\xF3n de llamada obsoleta set_brightness_delay.\
    \ Para corregir el error, este parche cambia el registro y cancelaci\xF3n del\
    \ registro del dispositivo de clase LED de forma manual sin devres, manteniendo\
    \ las instancias en hda_gen_spec."
id: CVE-2022-48735
lastModified: '2024-08-19T16:41:21.037'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-06-20T12:15:11.890'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0e629052f013eeb61494d4df2f1f647c2a9aef47
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/549f8ffc7b2f7561bea7f90930b6c5104318e87b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/813e9f3e06d22e29872d4fd51b54992d89cf66c8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/a7de1002135cf94367748ffc695a29812d7633b5
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
