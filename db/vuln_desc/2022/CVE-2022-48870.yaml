configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 82544A71-562D-4C2F-B75E-7193C3B97CD0
      versionEndExcluding: 5.15.90
      versionStartIncluding: '5.12'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A6AFE6C9-3F59-4711-B2CF-7D6682FF6BD0
      versionEndExcluding: 6.1.8
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    tty: fix possible null-ptr-defer in spk_ttyio_release\n\nRun the following tests\
    \ on the qemu platform:\n\nsyzkaller:~# modprobe speakup_audptr\n input: Speakup\
    \ as /devices/virtual/input/input4\n initialized device: /dev/synth, node (MAJOR\
    \ 10, MINOR 125)\n speakup 3.1.6: initialized\n synth name on entry is: (null)\n\
    \ synth probe\n\nspk_ttyio_initialise_ldisc failed because tty_kopen_exclusive\
    \ returned\nfailed (errno -16), then remove the module, we will get a null-ptr-defer\n\
    problem, as follow:\n\nsyzkaller:~# modprobe -r speakup_audptr\n releasing synth\
    \ audptr\n BUG: kernel NULL pointer dereference, address: 0000000000000080\n #PF:\
    \ supervisor write access in kernel mode\n #PF: error_code(0x0002) - not-present\
    \ page\n PGD 0 P4D 0\n Oops: 0002 [#1] PREEMPT SMP PTI\n CPU: 2 PID: 204 Comm:\
    \ modprobe Not tainted 6.1.0-rc6-dirty #1\n RIP: 0010:mutex_lock+0x14/0x30\n Call\
    \ Trace:\n <TASK>\n  spk_ttyio_release+0x19/0x70 [speakup]\n  synth_release.part.6+0xac/0xc0\
    \ [speakup]\n  synth_remove+0x56/0x60 [speakup]\n  __x64_sys_delete_module+0x156/0x250\n\
    \  ? fpregs_assert_state_consistent+0x1d/0x50\n  do_syscall_64+0x37/0x90\n  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\
    \ </TASK>\n Modules linked in: speakup_audptr(-) speakup\n Dumping ftrace buffer:\n\
    \nin_synth->dev was not initialized during modprobe, so we add check\nfor in_synth->dev\
    \ to fix this bug."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: tty:\
    \ corrige posible null-ptr-defer en spk_ttyio_release Ejecute las siguientes pruebas\
    \ en la plataforma qemu: syzkaller:~# modprobe Speakup_audptr input: Speakup as\
    \ /devices/virtual/input/input4 dispositivo inicializado: /dev/synth, nodo (MAJOR\
    \ 10, MINOR 125) Speakup 3.1.6: el nombre del sintetizador inicializado en la\
    \ entrada es: (nulo) la sonda de sintetizador spk_ttyio_initialise_ldisc fall\xF3\
    \ porque tty_kopen_exclusive devolvi\xF3 un error (errno -16), luego elimine el\
    \ m\xF3dulo, obtendremos un problema de aplazamiento de ptr nulo, como sigue:\
    \ syzkaller:~# modprobe -r Speakup_audptr liberando sintetizador audptr ERROR:\
    \ desreferencia del puntero NULL del kernel, direcci\xF3n: 00000000000000080 #PF:\
    \ acceso de escritura del supervisor en modo kernel #PF: c\xF3digo_error(0x0002\
    \ ) - p\xE1gina no presente PGD 0 P4D 0 Ups: 0002 [#1] PREEMPT SMP PTI CPU: 2\
    \ PID: 204 Comm: modprobe No contaminado 6.1.0-rc6-dirty #1 RIP: 0010:mutex_lock+0x14/0x30\
    \ Llamada Seguimiento:  spk_ttyio_release+0x19/0x70 [speakup] synth_release.part.6+0xac/0xc0\
    \ [speakup] synth_remove+0x56/0x60 [speakup] __x64_sys_delete_module+0x156/0x250?\
    \ fpregs_assert_state_consistent+0x1d/0x50 do_syscall_64+0x37/0x90 entry_syscall_64_after_hwframe+0x63/0xcd\
    \  m\xF3dulos vinculados en: sheakup_audptr (-) volcando ftrace b\xFAfer: in_synth-&gt;&gt;\
    \ nth-&gt; dev para corregir este error."
id: CVE-2022-48870
lastModified: '2024-09-06T14:20:52.290'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-08-21T07:15:04.143'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2da67bff29ab49caafb0766e8b8383b735ff796f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5abbeebd8296c2301023b8dc4b5a6c0d5229b4f5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/64152e05a4de3ebf59f1740a0985a6d5fba0c77b
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
