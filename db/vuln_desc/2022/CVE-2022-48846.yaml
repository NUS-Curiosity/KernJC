configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6C0FC864-77A5-46FD-A8AB-1D4AB43DFFD4
      versionEndExcluding: 5.15.31
      versionStartIncluding: '5.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: DC9A634D-C617-4F8C-ADEF-AF94CE69D687
      versionEndExcluding: 5.16.17
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    block: release rq qos structures for queue without disk


    blkcg_init_queue() may add rq qos structures to request queue, previously

    blk_cleanup_queue() calls rq_qos_exit() to release them, but commit

    8e141f9eb803 ("block: drain file system I/O on del_gendisk")

    moves rq_qos_exit() into del_gendisk(), so memory leak is caused

    because queues may not have disk, such as un-present scsi luns, nvme

    admin queue, ...


    Fixes the issue by adding rq_qos_exit() to blk_cleanup_queue() back.


    BTW, v5.18 won''t need this patch any more since we move

    blkcg_init_queue()/blkcg_exit_queue() into disk allocation/release

    handler, and patches have been in for-5.18/block.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: bloque:\
    \ liberar estructuras rq qos para cola sin disco blkcg_init_queue() puede agregar\
    \ estructuras rq qos para solicitar cola, previamente blk_cleanup_queue() llama\
    \ a rq_qos_exit() para liberarlas, pero commit 8e141f9eb803 ( \"bloque: drenar\
    \ la E/S del sistema de archivos en del_gendisk\") mueve rq_qos_exit() a del_gendisk(),\
    \ por lo que la p\xE9rdida de memoria se debe a que es posible que las colas no\
    \ tengan disco, como los luns scsi no presentes, la cola de administraci\xF3n\
    \ de nvme, ... solucione el problema agregando rq_qos_exit() a blk_cleanup_queue()\
    \ nuevamente. Por cierto, v5.18 ya no necesitar\xE1 este parche ya que movemos\
    \ blkcg_init_queue()/blkcg_exit_queue() al controlador de asignaci\xF3n/liberaci\xF3\
    n de disco, y los parches han estado en for-5.18/block."
id: CVE-2022-48846
lastModified: '2024-07-24T17:56:26.767'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-16T13:15:11.883'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/60c2c8e2ef3a3ec79de8cbc80a06ca0c21df8c29
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d4ad8736ac982111bb0be8306bf19c8207f6600e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/daaca3522a8e67c46e39ef09c1d542e866f85f3b
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-401
  source: nvd@nist.gov
  type: Primary
