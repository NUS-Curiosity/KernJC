configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 21912390-FBA5-4A90-B649-77DB55849C77
      versionEndExcluding: 4.9.304
      versionStartIncluding: 2.6.16
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: F0F577D3-EFEA-42CF-80AA-905297529D7F
      versionEndExcluding: 4.14.269
      versionStartIncluding: '4.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: EF11C6DC-8B9A-4A37-B1E6-33B68F5366ED
      versionEndExcluding: 4.19.232
      versionStartIncluding: '4.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: EE74CED8-43BF-4060-9578-93A09735B4E2
      versionEndExcluding: 5.4.182
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 1A95B717-3110-4D4F-B8FC-373919BB514D
      versionEndExcluding: 5.10.103
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9AB342AE-A62E-4947-A6EA-511453062B2B
      versionEndExcluding: 5.15.26
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C76BAB21-7F23-4AD8-A25F-CA7B262A2698
      versionEndExcluding: 5.16.12
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    configfs: fix a race in configfs_{,un}register_subsystem()\n\nWhen configfs_register_subsystem()\
    \ or configfs_unregister_subsystem()\nis executing link_group() or unlink_group(),\n\
    it is possible that two processes add or delete list concurrently.\nSome unfortunate\
    \ interleavings of them can cause kernel panic.\n\nOne of cases is:\nA --> B -->\
    \ C --> D\nA <-- B <-- C <-- D\n\n     delete list_head *B        |      delete\
    \ list_head *C\n--------------------------------|-----------------------------------\n\
    configfs_unregister_subsystem   |   configfs_unregister_subsystem\n  unlink_group\
    \                  |     unlink_group\n    unlink_obj                  |     \
    \  unlink_obj\n      list_del_init             |         list_del_init\n     \
    \   __list_del_entry        |           __list_del_entry\n          __list_del\
    \            |             __list_del\n            // next == C        |\n   \
    \         next->prev = prev   |\n                                |           \
    \    next->prev = prev\n            prev->next = next   |\n                  \
    \              |                 // prev == B\n                              \
    \  |                 prev->next = next\n\nFix this by adding mutex when calling\
    \ link_group() or unlink_group(),\nbut parent configfs_subsystem is NULL when\
    \ config_item is root.\nSo I create a mutex configfs_subsystem_mutex."
- lang: es
  value: "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: configfs:\
    \ arregla una ejecuci\xF3n en configfs_{,un}register_subsystem() Cuando configfs_register_subsystem()\
    \ o configfs_unregister_subsystem() est\xE1 ejecutando link_group() o unlink_group(),\
    \ es posible que dos procesos agregar o eliminar la lista al mismo tiempo. Algunas\
    \ intercalaciones desafortunadas de ellos pueden causar p\xE1nico en el kernel.\
    \ Uno de los casos es: A --&gt; B --&gt; C --&gt; DA &lt;-- B &lt;-- C &lt;--\
    \ D eliminar list_head *B | eliminar list_head *C --------------------------------|-------------\
    \ ---------------------- configfs_unregister_subsystem | configfs_unregister_subsystem\
    \ unlink_group | desvincular_grupo desvincular_obj | unlink_obj list_del_init\
    \ | list_del_init __list_del_entry | __list_del_entry __list_del | __list_del\
    \ // siguiente == C | siguiente-&gt;anterior = anterior | | siguiente-&gt;anterior\
    \ = anterior anterior-&gt;siguiente = siguiente | | // anterior == B | prev-&gt;next\
    \ = next Solucione esto agregando mutex al llamar a link_group() o unlink_group(),\
    \ pero el configfs_subsystem principal es NULL cuando config_item es root. Entonces\
    \ creo un mutex configfs_subsystem_mutex."
id: CVE-2022-48931
lastModified: '2024-08-23T01:54:11.640'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 4.7
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.0
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-08-22T04:15:16.010'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3aadfd46858b1f64d4d6a0654b863e21aabff975
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/40805099af11f68c5ca7dbcfacf455da8f99f622
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/84ec758fb2daa236026506868c8796b0500c047d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/a37024f7757c25550accdebf49e497ad6ae239fe
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/a7ab53d3c27dfe83bb594456b9f38a37796ec39b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b7e2b91fcb5c78c414e33dc8d50642e307ca0c5a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d1654de19d42f513b6cfe955cc77e7f427e05a77
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e7a66dd2687758718eddd79b542a95cf3aa488cc
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-362
  source: nvd@nist.gov
  type: Primary
