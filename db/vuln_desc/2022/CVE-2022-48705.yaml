cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    wifi: mt76: mt7921e: fix crash in chip reset fail


    In case of drv own fail in reset, we may need to run mac_reset several

    times. The sequence would trigger system crash as the log below.


    Because we do not re-enable/schedule "tx_napi" before disable it again,

    the process would keep waiting for state change in napi_diable(). To

    avoid the problem and keep status synchronize for each run, goto final

    resource handling if drv own failed.


    [ 5857.353423] mt7921e 0000:3b:00.0: driver own failed

    [ 5858.433427] mt7921e 0000:3b:00.0: Timeout for driver own

    [ 5859.633430] mt7921e 0000:3b:00.0: driver own failed

    [ 5859.633444] ------------[ cut here ]------------

    [ 5859.633446] WARNING: CPU: 6 at kernel/kthread.c:659 kthread_park+0x11d

    [ 5859.633717] Workqueue: mt76 mt7921_mac_reset_work [mt7921_common]

    [ 5859.633728] RIP: 0010:kthread_park+0x11d/0x150

    [ 5859.633736] RSP: 0018:ffff8881b676fc68 EFLAGS: 00010202

    ......

    [ 5859.633766] Call Trace:

    [ 5859.633768]  <TASK>

    [ 5859.633771]  mt7921e_mac_reset+0x176/0x6f0 [mt7921e]

    [ 5859.633778]  mt7921_mac_reset_work+0x184/0x3a0 [mt7921_common]

    [ 5859.633785]  ? mt7921_mac_set_timing+0x520/0x520 [mt7921_common]

    [ 5859.633794]  ? __kasan_check_read+0x11/0x20

    [ 5859.633802]  process_one_work+0x7ee/0x1320

    [ 5859.633810]  worker_thread+0x53c/0x1240

    [ 5859.633818]  kthread+0x2b8/0x370

    [ 5859.633824]  ? process_one_work+0x1320/0x1320

    [ 5859.633828]  ? kthread_complete_and_exit+0x30/0x30

    [ 5859.633834]  ret_from_fork+0x1f/0x30

    [ 5859.633842]  </TASK>'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: wifi:\
    \ mt76: mt7921e: reparaci\xF3n del fallo en el reinicio del chip. En caso de que\
    \ el propio drv falle en el reinicio, es posible que necesitemos ejecutar mac_reset\
    \ varias veces. La secuencia provocar\xEDa un fallo del sistema como se muestra\
    \ en el siguiente registro. Debido a que no volvemos a habilitar/programar \"\
    tx_napi\" antes de deshabilitarlo nuevamente, el proceso seguir\xE1 esperando\
    \ el cambio de estado en napi_diable(). Para evitar el problema y mantener el\
    \ estado sincronizado para cada ejecuci\xF3n, vaya al manejo de recursos finales\
    \ si el propio drv falla. [ 5857.353423] mt7921e 0000:3b:00.0: el controlador\
    \ propio fall\xF3 [ 5858.433427] mt7921e 0000:3b:00.0: Tiempo de espera para el\
    \ controlador propio [ 5859.633430] mt7921e 0000:3b:00.0: el controlador propio\
    \ fall\xF3 [ 5859. 633444] ------- -----[ cortar aqu\xED ]------------ [ 5859.633446]\
    \ ADVERTENCIA: CPU: 6 en kernel/kthread.c:659 kthread_park+0x11d [ 5859.633717]\
    \ Cola de trabajo: mt76 mt7921_mac_reset_work [mt7921_common] [ 5859.633728] RIP:\
    \ 0010:kthread_park+0x11d/0x150 [ 5859.633736] RSP: 0018:ffff8881b676fc68 EFLAGS:\
    \ 00010202 ...... [ 5859.633766] Seguimiento de llamadas: [ 5859.633768 ]  [ 5859.633771]\
    \ mt7921e_mac_reset+0x176/0x6f0 [ mt7921e] [5859.633778] mt7921_mac_reset_work+0x184/0x3a0\
    \ [mt7921_common] [5859.633785]? mt7921_mac_set_timing+0x520/0x520 [mt7921_common]\
    \ [5859.633794]? __kasan_check_read+0x11/0x20 [ 5859.633802] proceso_one_work+0x7ee/0x1320\
    \ [ 5859.633810] trabajador_thread+0x53c/0x1240 [ 5859.633818] kthread+0x2b8/0x370\
    \ [ 5859.633824] ? proceso_one_work+0x1320/0x1320 [5859.633828]? kthread_complete_and_exit+0x30/0x30\
    \ [ 5859.633834] ret_from_fork+0x1f/0x30 [ 5859.633842] "
id: CVE-2022-48705
lastModified: '2024-05-06T12:44:56.377'
metrics: {}
published: '2024-05-03T18:15:08.403'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f7f3001723e337568017e8617974f29bc8b2f595
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/fa3fbe64037839f448dc569212bafc5a495d8219
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
