configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E58D7990-F870-451F-A267-BF81F7ABEAEB
      versionEndExcluding: 5.10.99
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 74528AA6-B524-4C3F-B188-1194235FE47D
      versionEndExcluding: 5.15.22
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0623892A-E3E4-44E6-8A5E-39A0B47AF782
      versionEndExcluding: 5.16.8
      versionStartIncluding: '5.16'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    selinux: fix double free of cond_list on error paths


    On error path from cond_read_list() and duplicate_policydb_cond_list()

    the cond_list_destroy() gets called a second time in caller functions,

    resulting in NULL pointer deref.  Fix this by resetting the

    cond_list_len to 0 in cond_list_destroy(), making subsequent calls a

    noop.


    Also consistently reset the cond_list pointer to NULL after freeing.


    [PM: fix line lengths in the description]'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: selinux:\
    \ corrige el doble libre de cond_list en rutas de error En la ruta de error de\
    \ cond_read_list() y duplicado_policydb_cond_list(), se llama a cond_list_destroy()\
    \ por segunda vez en las funciones de llamada, lo que resulta en un puntero NULL\
    \ deref. Solucione este problema restableciendo cond_list_len a 0 en cond_list_destroy(),\
    \ haciendo que las llamadas posteriores sean un error. Tambi\xE9n restablezca\
    \ constantemente el puntero cond_list a NULL despu\xE9s de liberarlo. [PM: corrija\
    \ la longitud de las l\xEDneas en la descripci\xF3n]"
id: CVE-2022-48740
lastModified: '2024-08-19T17:03:31.843'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-06-20T12:15:12.330'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/186edf7e368c40d06cf727a1ad14698ea67b74ad
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/70caa32e6d81f45f0702070c0e4dfe945e92fbd7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/7ed9cbf7ac0d4ed86b356e1b944304ae9ee450d4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f446089a268c8fc6908488e991d28a9b936293db
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-415
  source: nvd@nist.gov
  type: Primary
