configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 14893A53-0846-4D56-BC73-9FC4261FDAB2
      versionEndExcluding: 6.1.8
      versionStartIncluding: '5.19'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    dmaengine: idxd: Prevent use after free on completion memory\n\nOn driver unload\
    \ any pending descriptors are flushed at the\ntime the interrupt is freed:\nidxd_dmaengine_drv_remove()\
    \ ->\n\tdrv_disable_wq() ->\n\t\tidxd_wq_free_irq() ->\n\t\t\tidxd_flush_pending_descs().\n\
    \nIf there are any descriptors present that need to be flushed this\nflow triggers\
    \ a \"not present\" page fault as below:\n\n BUG: unable to handle page fault\
    \ for address: ff391c97c70c9040\n #PF: supervisor read access in kernel mode\n\
    \ #PF: error_code(0x0000) - not-present page\n\nThe address that triggers the\
    \ fault is the address of the\ndescriptor that was freed moments earlier via:\n\
    drv_disable_wq()->idxd_wq_free_resources()\n\nFix the use after free by freeing\
    \ the descriptors after any possible\nusage. This is done after idxd_wq_reset()\
    \ to ensure that the memory\nremains accessible during possible completion writes\
    \ by the device."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: dmaengine:\
    \ idxd: evita el use after free la memoria al finalizar. Al descargar el controlador,\
    \ los descriptores pendientes se eliminan en el momento en que se libera la interrupci\xF3\
    n: idxd_dmaengine_drv_remove() -&gt; drv_disable_wq() -&gt; idxd_wq_free_irq ()\
    \ -&gt; idxd_flush_pending_descs(). Si hay alg\xFAn descriptor presente que deba\
    \ eliminarse, este flujo desencadena un error de p\xE1gina \"no presente\" como\
    \ se muestra a continuaci\xF3n: ERROR: no se puede manejar el error de p\xE1gina\
    \ para la direcci\xF3n: ff391c97c70c9040 #PF: acceso de lectura del supervisor\
    \ en modo kernel #PF: error_code(0x0000 ) - p\xE1gina no presente La direcci\xF3\
    n que desencadena la falla es la direcci\xF3n del descriptor que se liber\xF3\
    \ momentos antes a trav\xE9s de: drv_disable_wq()-&gt;idxd_wq_free_resources()\
    \ Corrige el use-after-free liberando los descriptores despu\xE9s de cualquier\
    \ posible uso. Esto se hace despu\xE9s de idxd_wq_reset() para garantizar que\
    \ la memoria permanezca accesible durante posibles escrituras completas por parte\
    \ del dispositivo."
id: CVE-2022-48867
lastModified: '2024-09-06T14:15:33.733'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-08-21T07:15:03.860'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1beeec45f9ac31eba52478379f70a5fa9c2ad005
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b9e8e3fcfec625fc1c2f68f684448aeeb882625b
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
