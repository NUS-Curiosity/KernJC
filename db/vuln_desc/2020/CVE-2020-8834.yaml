configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:-:*:*:*:*:*:*:*
      matchCriteriaId: 703AF700-7A70-47E2-BC3A-7FD03B3CA9C1
      vulnerable: true
    negate: false
    operator: OR
  - cpeMatch:
    - criteria: cpe:2.3:h:ibm:power8:-:*:*:*:*:*:*:*
      matchCriteriaId: 1227B6B9-593A-4715-BC98-6945670AED37
      vulnerable: false
    negate: false
    operator: OR
  operator: AND
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
      matchCriteriaId: F7016A2A-8365-4F1A-89A2-7A19F2BCAE5B
      vulnerable: true
    - criteria: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
      matchCriteriaId: 23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D
      vulnerable: true
    negate: false
    operator: OR
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*
      matchCriteriaId: B620311B-34A3-48A6-82DF-6F078D7A4493
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1
    to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading
    to a stack corruption. Because of this, an attacker with the ability run code
    in kernel space of a guest VM can cause the host kernel to panic. There were two
    commits that, according to the reporter, introduced the vulnerability: f024ee098476
    ("KVM: PPC: Book3S HV: Pull out TM state save/restore into separate procedures")
    87a11bb6a7f7 ("KVM: PPC: Book3S HV: Work around XER[SO] bug in fake suspend mode")
    The former landed in 4.8, the latter in 4.17. This was fixed without realizing
    the impact in 4.18 with the following three commits, though it''s believed the
    first is the only strictly necessary commit: 6f597c6b63b6 ("KVM: PPC: Book3S PR:
    Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()") 7b0e827c6970
    ("KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm")
    009c872a8bc4 ("KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to separate
    file")'
- lang: es
  value: "KVM en el kernel de Linux en los procesadores Power8, presenta un uso conflictivo\
    \ de HSTATE_HOST_R1 para almacenar el estado r1 en plus kvmppc_hv_entry en kvmppc_\
    \ {save, restore} _tm, conllevando a una corrupci\xF3n de la pila. Debido a esto,\
    \ un atacante con la capacidad de ejecutar c\xF3digo en el espacio del kernel\
    \ de una M\xE1quina Virtual invitada puede causar que el kernel del host entre\
    \ en p\xE1nico. Se presentaron dos commits que, de acuerdo con el reportero, introdujeron\
    \ la vulnerabilidad: f024ee098476 (\"KVM: PPC: Book3S HV: Pull out TM state save/restore\
    \ into separate procedures\") 87a11bb6a7f7 (\"KVM: PPC: Book3S HV: Work around\
    \ XER[SO] bug in fake suspend mode\") El primero se consigui\xF3 en la versi\xF3\
    n 4.8, el \xFAltimo en la versi\xF3n 4.17. Esto se corrigi\xF3 sin conocer el\
    \ impacto en la versi\xF3n 4.18 con los siguientes tres commits, aunque se cree\
    \ que el primero es el \xFAnico commit estrictamente necesario: 6f597c6b63b6 (\"\
    KVM: PPC: Book3S PR: Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()\"\
    ) 7b0e827c6970 (\"KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm\"\
    ) 009c872a8bc4 (\"KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to\
    \ separate file\")"
id: CVE-2020-8834
lastModified: '2022-10-07T15:43:06.733'
metrics:
  cvssMetricV2:
  - acInsufInfo: false
    baseSeverity: MEDIUM
    cvssData:
      accessComplexity: LOW
      accessVector: LOCAL
      authentication: NONE
      availabilityImpact: COMPLETE
      baseScore: 4.9
      confidentialityImpact: NONE
      integrityImpact: NONE
      vectorString: AV:L/AC:L/Au:N/C:N/I:N/A:C
      version: '2.0'
    exploitabilityScore: 3.9
    impactScore: 6.9
    obtainAllPrivilege: false
    obtainOtherPrivilege: false
    obtainUserPrivilege: false
    source: nvd@nist.gov
    type: Primary
    userInteractionRequired: false
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 6.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: CHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 2.0
    impactScore: 4.0
    source: nvd@nist.gov
    type: Primary
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 6.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: CHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 2.0
    impactScore: 4.0
    source: security@ubuntu.com
    type: Secondary
published: '2020-04-09T22:15:12.050'
references:
- source: security@ubuntu.com
  tags:
  - Mailing List
  - Third Party Advisory
  url: http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00035.html
- source: security@ubuntu.com
  tags:
  - Exploit
  - Third Party Advisory
  url: https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1867717
- source: security@ubuntu.com
  tags:
  - Third Party Advisory
  url: https://usn.ubuntu.com/4318-1/
- source: security@ubuntu.com
  tags:
  - Third Party Advisory
  url: https://usn.ubuntu.com/usn/usn-4318-1
- source: security@ubuntu.com
  tags:
  - Mailing List
  - Third Party Advisory
  url: https://www.openwall.com/lists/oss-security/2020/04/06/2
sourceIdentifier: security@ubuntu.com
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-362
  source: nvd@nist.gov
  type: Primary
- description:
  - lang: en
    value: CWE-368
  source: security@ubuntu.com
  type: Secondary
