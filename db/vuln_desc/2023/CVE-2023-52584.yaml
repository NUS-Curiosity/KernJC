cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    spmi: mediatek: Fix UAF on device remove


    The pmif driver data that contains the clocks is allocated along with

    spmi_controller.

    On device remove, spmi_controller will be freed first, and then devres

    , including the clocks, will be cleanup.

    This leads to UAF because putting the clocks will access the clocks in

    the pmif driver data, which is already freed along with spmi_controller.


    This can be reproduced by enabling DEBUG_TEST_DRIVER_REMOVE and

    building the kernel with KASAN.


    Fix the UAF issue by using unmanaged clk_bulk_get() and putting the

    clocks before freeing spmi_controller.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: spmi:\
    \ mediatek: reparar UAF en la eliminaci\xF3n del dispositivo. Los datos del controlador\
    \ pmif que contienen los relojes se asignan junto con spmi_controller. Al eliminar\
    \ el dispositivo, primero se liberar\xE1 spmi_controller y luego se limpiar\xE1\
    n los devres, incluidos los relojes. Esto lleva a UAF porque al poner los relojes\
    \ se acceder\xE1 a los relojes en los datos del controlador pmif, que ya est\xE1\
    n liberados junto con spmi_controller. Esto se puede reproducir habilitando DEBUG_TEST_DRIVER_REMOVE\
    \ y compilando el kernel con KASAN. Solucione el problema de UAF utilizando clk_bulk_get()\
    \ no administrado y poniendo los relojes antes de liberar spmi_controller."
id: CVE-2023-52584
lastModified: '2024-08-06T14:35:04.610'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: NETWORK
      availabilityImpact: NONE
      baseScore: 3.8
      baseSeverity: LOW
      confidentialityImpact: LOW
      integrityImpact: LOW
      privilegesRequired: HIGH
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N
      version: '3.1'
    exploitabilityScore: 1.2
    impactScore: 2.5
    source: 134c704f-9b21-4f2e-91b3-4a467353bcc0
    type: Secondary
published: '2024-03-06T07:15:07.227'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/521f28eedd6b14228c46e3b81e3bf9b90c2818d8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/9a3881b1f07db1bb55cb0108e6f05cfd027eaf2e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/e821d50ab5b956ed0effa49faaf29912fd4106d9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f8dcafcb54632536684336161da8bdd52120f95e
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: 134c704f-9b21-4f2e-91b3-4a467353bcc0
  type: Secondary
