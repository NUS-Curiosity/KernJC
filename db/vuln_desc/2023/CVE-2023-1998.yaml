configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 3769AA63-B0A8-4EF1-96F9-6A6A6B305A02
      versionEndExcluding: '6.3'
      vulnerable: true
    negate: false
    operator: OR
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
      matchCriteriaId: 07B237A9-69A3-4A9C-9DA0-4E06BD37AE73
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'The Linux kernel allows userspace processes to enable mitigations by calling
    prctl with PR_SET_SPECULATION_CTRL which disables the speculation feature as well
    as by using seccomp. We had noticed that on VMs of at least one major cloud provider,
    the kernel still left the victim process exposed to attacks in some cases even
    after enabling the spectre-BTI mitigation with prctl. The same behavior can be
    observed on a bare-metal machine when forcing the mitigation to IBRS on boot command
    line.


    This happened because when plain IBRS was enabled (not enhanced IBRS), the kernel
    had some logic that determined that STIBP was not needed. The IBRS bit implicitly
    protects against cross-thread branch target injection. However, with legacy IBRS,
    the IBRS bit was cleared on returning to userspace, due to performance reasons,
    which disabled the implicit STIBP and left userspace threads vulnerable to cross-thread
    branch target injection against which STIBP protects.



    '
id: CVE-2023-1998
lastModified: '2023-05-03T15:16:29.733'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: NONE
      baseScore: 5.6
      baseSeverity: MEDIUM
      confidentialityImpact: HIGH
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: CHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
      version: '3.1'
    exploitabilityScore: 1.1
    impactScore: 4.0
    source: nvd@nist.gov
    type: Primary
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: NONE
      baseScore: 5.6
      baseSeverity: MEDIUM
      confidentialityImpact: HIGH
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: CHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N
      version: '3.1'
    exploitabilityScore: 1.1
    impactScore: 4.0
    source: cve-coordination@google.com
    type: Secondary
published: '2023-04-21T15:15:07.080'
references:
- source: cve-coordination@google.com
  tags:
  - Exploit
  - Third Party Advisory
  url: https://github.com/google/security-research/security/advisories/GHSA-mj4w-6495-6crx
- source: cve-coordination@google.com
  tags:
  - Patch
  url: https://github.com/torvalds/linux/commit/6921ed9049bc7457f66c1596c5b78aec0dae4a9d
- source: cve-coordination@google.com
  tags:
  - Not Applicable
  url: https://kernel.dance/#6921ed9049bc7457f66c1596c5b78aec0dae4a9d
- source: cve-coordination@google.com
  tags:
  - Mailing List
  - Third Party Advisory
  url: https://lists.debian.org/debian-lts-announce/2023/05/msg00005.html
- source: cve-coordination@google.com
  tags:
  - Mailing List
  - Third Party Advisory
  url: https://lists.debian.org/debian-lts-announce/2023/05/msg00006.html
sourceIdentifier: cve-coordination@google.com
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-203
  source: nvd@nist.gov
  type: Primary
- description:
  - lang: en
    value: CWE-1303
  source: cve-coordination@google.com
  type: Secondary
