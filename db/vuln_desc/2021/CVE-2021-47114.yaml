cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    ocfs2: fix data corruption by fallocate\n\nWhen fallocate punches holes out of\
    \ inode size, if original isize is in\nthe middle of last cluster, then the part\
    \ from isize to the end of the\ncluster will be zeroed with buffer write, at that\
    \ time isize is not yet\nupdated to match the new size, if writeback is kicked\
    \ in, it will invoke\nocfs2_writepage()->block_write_full_page() where the pages\
    \ out of inode\nsize will be dropped.  That will cause file corruption.  Fix this\
    \ by\nzero out eof blocks when extending the inode size.\n\nRunning the following\
    \ command with qemu-image 4.2.1 can get a corrupted\ncoverted image file easily.\n\
    \n    qemu-img convert -p -t none -T none -f qcow2 $qcow_image \\\n          \
    \   -O qcow2 -o compat=1.1 $qcow_image.conv\n\nThe usage of fallocate in qemu\
    \ is like this, it first punches holes out\nof inode size, then extend the inode\
    \ size.\n\n    fallocate(11, FALLOC_FL_KEEP_SIZE|FALLOC_FL_PUNCH_HOLE, 2276196352,\
    \ 65536) = 0\n    fallocate(11, 0, 2276196352, 65536) = 0\n\nv1: https://www.spinics.net/lists/linux-fsdevel/msg193999.html\n\
    v2: https://lore.kernel.org/linux-fsdevel/20210525093034.GB4112@quack2.suse.cz/T/"
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: ocfs2:\
    \ corrige la corrupci\xF3n de datos por fallocate Cuando fallocate perfora agujeros\
    \ en el tama\xF1o del inodo, si el isize original est\xE1 en el medio del \xFA\
    ltimo cl\xFAster, entonces la parte desde isize hasta el final del cl\xFAster\
    \ se pondr\xE1 a cero con la escritura en el b\xFAfer, en ese momento isize a\xFA\
    n no se ha actualizado para que coincida con el nuevo tama\xF1o, si se activa\
    \ la reescritura, invocar\xE1 ocfs2_writepage()-&gt;block_write_full_page() donde\
    \ se eliminar\xE1n las p\xE1ginas fuera del tama\xF1o del inodo. Eso causar\xE1\
    \ corrupci\xF3n de archivos. Solucione este problema poniendo a cero los bloques\
    \ eof al extender el tama\xF1o del inodo. Ejecutar el siguiente comando con qemu-image\
    \ 4.2.1 puede obtener f\xE1cilmente un archivo de imagen corrupto y convertido.\
    \ qemu-img convert -p -t none -T none -f qcow2 $qcow_image \\ -O qcow2 -o compat=1.1\
    \ $qcow_image.conv El uso de fallocate en qemu es as\xED, primero perfora agujeros\
    \ en el tama\xF1o del inodo, luego ampliar el tama\xF1o del inodo. fallocate(11,\
    \ FALLOC_FL_KEEP_SIZE|FALLOC_FL_PUNCH_HOLE, 2276196352, 65536) = 0 fallocate(11,\
    \ 0, 2276196352, 65536) = 0 v1: https://www.spinics.net/lists/linux-fsdevel/msg193999.html\
    \ v2: https //lore.kernel.org/linux-fsdevel/20210525093034.GB4112@quack2.suse.cz/T/"
id: CVE-2021-47114
lastModified: '2024-03-17T22:38:29.433'
metrics: {}
published: '2024-03-15T21:15:06.723'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/0a31dd6fd2f4e7db538fb6eb1f06973d81f8dd3b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/33e03adafb29eedae1bae9cdb50c1385279fcf65
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/624fa7baa3788dc9e57840ba5b94bc22b03cda57
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/6bba4471f0cc1296fe3c2089b9e52442d3074b2e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/a1700479524bb9cb5e8ae720236a6fabd003acae
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c8d5faee46242c3f33b8a71a4d7d52214785bfcc
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/cc2edb99ea606a45182b5ea38cc8f4e583aa0774
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/cec4e857ffaa8c447f51cd8ab4e72350077b6770
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
