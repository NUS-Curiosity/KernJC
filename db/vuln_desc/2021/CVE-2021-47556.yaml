configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 082C8F69-46F5-469A-A650-E0340F11BEF5
      versionEndExcluding: 5.15.6
      versionStartIncluding: '5.15'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    ethtool: ioctl: fix potential NULL deref in ethtool_set_coalesce()\n\nethtool_set_coalesce()\
    \ now uses both the .get_coalesce() and\n.set_coalesce() callbacks. But the check\
    \ for their availability is\nbuggy, so changing the coalesce settings on a device\
    \ where the driver\nprovides only _one_ of the callbacks results in a NULL pointer\n\
    dereference instead of an -EOPNOTSUPP.\n\nFix the condition so that the availability\
    \ of both callbacks is\nensured. This also matches the netlink code.\n\nNote that\
    \ reproducing this requires some effort - it only affects the\nlegacy ioctl path,\
    \ and needs a specific combination of driver options:\n- have .get_coalesce()\
    \ and .coalesce_supported but no\n .set_coalesce(), or\n- have .set_coalesce()\
    \ but no .get_coalesce(). Here eg. ethtool doesn't\n  cause the crash as it first\
    \ attempts to call ethtool_get_coalesce()\n  and bails out on error."
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: ethtool:\
    \ ioctl: corrige un posible deref NULL en ethtool_set_coalesce() ethtool_set_coalesce()\
    \ ahora usa las devoluciones de llamada .get_coalesce() y .set_coalesce(). Pero\
    \ la verificaci\xF3n de su disponibilidad tiene errores, por lo que cambiar la\
    \ configuraci\xF3n de fusi\xF3n en un dispositivo donde el controlador proporciona\
    \ solo _una_ de las devoluciones de llamada da como resultado una desreferencia\
    \ del puntero NULL en lugar de un -EOPNOTSUPP. Corrija la condici\xF3n para que\
    \ se garantice la disponibilidad de ambas devoluciones de llamada. Esto tambi\xE9\
    n coincide con el c\xF3digo netlink. Tenga en cuenta que reproducir esto requiere\
    \ algo de esfuerzo: solo afecta la ruta ioctl heredada y necesita una combinaci\xF3\
    n espec\xEDfica de opciones de controlador: - tener .get_coalesce() y .coalesce_supported\
    \ pero no .set_coalesce(), o - tener .set_coalesce() pero no .get_coalesce().\
    \ Aqu\xED por ej. ethtool no causa el bloqueo ya que primero intenta llamar a\
    \ ethtool_get_coalesce() y sale por error."
id: CVE-2021-47556
lastModified: '2024-06-10T19:23:01.133'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-05-24T15:15:20.320'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0276af2176c78771da7f311621a25d7608045827
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/abfdd9e2f0f9699015d72317f74154d3e53664e6
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
