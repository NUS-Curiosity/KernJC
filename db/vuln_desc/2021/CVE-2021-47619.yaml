cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    i40e: Fix queues reservation for XDP


    When XDP was configured on a system with large number of CPUs

    and X722 NIC there was a call trace with NULL pointer dereference.


    i40e 0000:87:00.0: failed to get tracking for 256 queues for VSI 0 err -12

    i40e 0000:87:00.0: setup of MAIN VSI failed


    BUG: kernel NULL pointer dereference, address: 0000000000000000

    RIP: 0010:i40e_xdp+0xea/0x1b0 [i40e]

    Call Trace:

    ? i40e_reconfig_rss_queues+0x130/0x130 [i40e]

    dev_xdp_install+0x61/0xe0

    dev_xdp_attach+0x18a/0x4c0

    dev_change_xdp_fd+0x1e6/0x220

    do_setlink+0x616/0x1030

    ? ahci_port_stop+0x80/0x80

    ? ata_qc_issue+0x107/0x1e0

    ? lock_timer_base+0x61/0x80

    ? __mod_timer+0x202/0x380

    rtnl_setlink+0xe5/0x170

    ? bpf_lsm_binder_transaction+0x10/0x10

    ? security_capable+0x36/0x50

    rtnetlink_rcv_msg+0x121/0x350

    ? rtnl_calcit.isra.0+0x100/0x100

    netlink_rcv_skb+0x50/0xf0

    netlink_unicast+0x1d3/0x2a0

    netlink_sendmsg+0x22a/0x440

    sock_sendmsg+0x5e/0x60

    __sys_sendto+0xf0/0x160

    ? __sys_getsockname+0x7e/0xc0

    ? _copy_from_user+0x3c/0x80

    ? __sys_setsockopt+0xc8/0x1a0

    __x64_sys_sendto+0x20/0x30

    do_syscall_64+0x33/0x40

    entry_SYSCALL_64_after_hwframe+0x44/0xae

    RIP: 0033:0x7f83fa7a39e0


    This was caused by PF queue pile fragmentation due to

    flow director VSI queue being placed right after main VSI.

    Because of this main VSI was not able to resize its

    queue allocation for XDP resulting in no queues allocated

    for main VSI when XDP was turned on.


    Fix this by always allocating last queue in PF queue pile

    for a flow director VSI.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: i40e:\
    \ Arreglar la reserva de colas para XDP Cuando se configur\xF3 XDP en un sistema\
    \ con una gran cantidad de CPU y NIC X722, hubo un seguimiento de llamada con\
    \ desreferencia de puntero NULL. i40e 0000:87:00.0: no se pudo obtener el seguimiento\
    \ de 256 colas para VSI 0 err -12 i40e 0000:87:00.0: fall\xF3 la configuraci\xF3\
    n de VSI PRINCIPAL ERROR: desreferencia del puntero NULL del kernel, direcci\xF3\
    n: 00000000000000000 RIP: 0010:i40e_xdp+0xea/ 0x1b0 [i40e] Seguimiento de llamadas:?\
    \ i40e_reconfig_rss_queues+0x130/0x130 [i40e] dev_xdp_install+0x61/0xe0 dev_xdp_attach+0x18a/0x4c0\
    \ dev_change_xdp_fd+0x1e6/0x220 do_setlink+0x616/0x1030 ? ahci_port_stop+0x80/0x80?\
    \ ata_qc_issue+0x107/0x1e0? lock_timer_base+0x61/0x80? __mod_timer+0x202/0x380\
    \ rtnl_setlink+0xe5/0x170 ? bpf_lsm_binder_transaction+0x10/0x10? capacidad_seguridad+0x36/0x50\
    \ rtnetlink_rcv_msg+0x121/0x350 ? rtnl_calcit.isra.0+0x100/0x100 netlink_rcv_skb+0x50/0xf0\
    \ netlink_unicast+0x1d3/0x2a0 netlink_sendmsg+0x22a/0x440 sock_sendmsg+0x5e/0x60\
    \ __sys_sendto+0xf0/0x160 ? __sys_getsockname+0x7e/0xc0 ? _copia_de_usuario+0x3c/0x80\
    \ ? __sys_setsockopt+0xc8/0x1a0 __x64_sys_sendto+0x20/0x30 do_syscall_64+0x33/0x40\
    \ Entry_SYSCALL_64_after_hwframe+0x44/0xae RIP: 0033:0x7f83fa7a39e0 Esto fue causado\
    \ por la fragmentaci\xF3n de la pila de cola PF debido al flujo La cola VSI del\
    \ director se coloca justo despu\xE9s de la VSI principal. Debido a esto, la VSI\
    \ principal no pudo cambiar el tama\xF1o de su asignaci\xF3n de cola para XDP,\
    \ lo que provoc\xF3 que no se asignaran colas para la VSI principal cuando se\
    \ activ\xF3 XDP. Solucione este problema asignando siempre la \xFAltima cola en\
    \ la pila de colas PF para una VSI de director de flujo."
id: CVE-2021-47619
lastModified: '2024-06-20T12:43:25.663'
metrics: {}
published: '2024-06-20T11:15:54.560'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/00eddb0e4ea115154581d1049507a996acfc2d3e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4b3aa858268b7b9aeef02e5f9c4cd8f8fac101c8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/768eb705e6381f0c70ca29d4e66f19790d5d19a1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/92947844b8beee988c0ce17082b705c2f75f0742
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/be6998f232b8e4ca8225029e305b8329d89bfd59
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/d46fa4ea9756ef6cbcf9752d0832cc66e2d7121b
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
