configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 8CC64BCA-D219-487C-A123-4C470FE30AB2
      versionEndExcluding: 5.15.13
      versionStartIncluding: 5.15.0
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    mm/damon/dbgfs: fix ''struct pid'' leaks in ''dbgfs_target_ids_write()''


    DAMON debugfs interface increases the reference counts of ''struct pid''s

    for targets from the ''target_ids'' file write callback

    (''dbgfs_target_ids_write()''), but decreases the counts only in DAMON

    monitoring termination callback (''dbgfs_before_terminate()'').


    Therefore, when ''target_ids'' file is repeatedly written without DAMON

    monitoring start/termination, the reference count is not decreased and

    therefore memory for the ''struct pid'' cannot be freed.  This commit

    fixes this issue by decreasing the reference counts when ''target_ids'' is

    written.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mm/damon/dbgfs:\
    \ corrige las fugas de 'struct pid' en 'dbgfs_target_ids_write()' La interfaz\
    \ DAMON debugfs aumenta los recuentos de referencias de 'struct pid' para los\
    \ objetivos de la escritura del archivo 'target_ids' devoluci\xF3n de llamada\
    \ ('dbgfs_target_ids_write()'), pero disminuye los recuentos solo en la devoluci\xF3\
    n de llamada de terminaci\xF3n de monitoreo de DAMON ('dbgfs_before_terminate()').\
    \ Por lo tanto, cuando el archivo 'target_ids' se escribe repetidamente sin que\
    \ DAMON supervise el inicio/terminaci\xF3n, el recuento de referencias no disminuye\
    \ y, por lo tanto, no se puede liberar memoria para 'struct pid'. Este commit\
    \ soluciona este problema al disminuir el recuento de referencias cuando se escribe\
    \ 'target_ids'."
id: CVE-2021-46937
lastModified: '2024-04-10T18:59:16.507'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: NONE
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: HIGH
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-02-27T10:15:08.067'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ebb3f994dd92f8fb4d70c7541091216c1e10cb71
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ffe4a1ba1a82c416a6b3a09d46594f6a885ae141
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-668
  source: nvd@nist.gov
  type: Primary
