configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 4E778606-3A80-42DD-996C-5570B1192986
      versionEndExcluding: 5.10.36
      versionStartIncluding: 5.10.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: EFB425F0-C28C-4B44-8B4C-AD512AA832DE
      versionEndExcluding: 5.11.20
      versionStartIncluding: 5.11.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C3814FA3-8141-4313-A852-8C4212BE12AD
      versionEndExcluding: 5.12.3
      versionStartIncluding: 5.12.0
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    tools/power turbostat: Fix offset overflow issue in index converting


    The idx_to_offset() function returns type int (32-bit signed), but

    MSR_PKG_ENERGY_STAT is u32 and would be interpreted as a negative number.

    The end result is that it hits the if (offset < 0) check in update_msr_sum()

    which prevents the timer callback from updating the stat in the background when

    long durations are used. The similar issue exists in offset_to_idx() and

    update_msr_sum(). Fix this issue by converting the ''int'' to ''off_t'' accordingly.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: herramientas/turbostat\
    \ de potencia: soluciona el problema de desbordamiento de compensaci\xF3n en la\
    \ conversi\xF3n de \xEDndice. La funci\xF3n idx_to_offset() devuelve el tipo int\
    \ (32 bits firmado), pero MSR_PKG_ENERGY_STAT es u32 y se interpretar\xEDa como\
    \ negativo. n\xFAmero. El resultado final es que alcanza la verificaci\xF3n if\
    \ (offset &lt; 0) en update_msr_sum(), lo que evita que la devoluci\xF3n de llamada\
    \ del temporizador actualice la estad\xEDstica en segundo plano cuando se utilizan\
    \ duraciones prolongadas. Existe un problema similar en offset_to_idx() y update_msr_sum().\
    \ Solucione este problema convirtiendo 'int' a 'off_t' en consecuencia."
id: CVE-2021-46940
lastModified: '2024-04-10T19:44:37.227'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-02-27T19:04:05.927'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/13a779de4175df602366d129e41782ad7168cef0
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/337b1546cde87fb8588ddaedf0201b769baa572a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/dbdf22fc825fdb1d97f23230064e0f9819471628
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ea6803ff2cd1a2d7d880256bf562172b708a76ff
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-190
  source: nvd@nist.gov
  type: Primary
