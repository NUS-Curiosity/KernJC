configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ADB9EFEF-ACB0-4A8F-AB11-363006921493
      versionEndExcluding: 4.4.294
      versionStartIncluding: '3.9'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: DB7F6C04-42D3-48A3-892D-2487383B9B6E
      versionEndExcluding: 4.9.292
      versionStartIncluding: '4.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 7080D941-9847-42F5-BA50-0A03CFB61FD1
      versionEndExcluding: 4.14.257
      versionStartIncluding: '4.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FFE5D9F3-CF1C-4DE8-9116-2EBE7BDEF7FD
      versionEndExcluding: 4.19.220
      versionStartIncluding: '4.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D2D8DC10-1823-4334-BD0F-C1B620602FF9
      versionEndExcluding: 5.4.164
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: AE5B4333-2C46-40C3-8B42-0168AD91DDE1
      versionEndExcluding: 5.10.84
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A696A60B-2782-4119-83DD-1EFFBC903F02
      versionEndExcluding: 5.15.7
      versionStartIncluding: '5.11'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    net: qlogic: qlcnic: Fix a NULL pointer dereference in qlcnic_83xx_add_rings()


    In qlcnic_83xx_add_rings(), the indirect function of

    ahw->hw_ops->alloc_mbx_args will be called to allocate memory for

    cmd.req.arg, and there is a dereference of it in qlcnic_83xx_add_rings(),

    which could lead to a NULL pointer dereference on failure of the

    indirect function like qlcnic_83xx_alloc_mbx_args().


    Fix this bug by adding a check of alloc_mbx_args(), this patch

    imitates the logic of mbx_cmd()''s failure handling.


    This bug was found by a static analyzer. The analysis employs

    differential checking to identify inconsistent security operations

    (e.g., checks or kfrees) between two code paths and confirms that the

    inconsistent operations are not recovered in the current function or

    the callers, so they constitute bugs.


    Note that, as a bug found by static analysis, it can be a false

    positive or hard to trigger. Multiple researchers have cross-reviewed

    the bug.


    Builds with CONFIG_QLCNIC=m show no new warnings, and our

    static analyzer no longer warns about this code.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net:\
    \ qlogic: qlcnic: corrigi\xF3 una desreferencia de puntero NULL en qlcnic_83xx_add_rings()\
    \ En qlcnic_83xx_add_rings(), se llamar\xE1 a la funci\xF3n indirecta de ahw-&gt;hw_ops-&gt;alloc_mbx_args\
    \ para asignar memoria para cmd.req.arg, y hay una desreferencia del mismo en\
    \ qlcnic_83xx_add_rings(), lo que podr\xEDa llevar a una desreferencia del puntero\
    \ NULL en caso de falla de la funci\xF3n indirecta como qlcnic_83xx_alloc_mbx_args().\
    \ Corrija este error agregando una verificaci\xF3n de alloc_mbx_args(); este parche\
    \ imita la l\xF3gica del manejo de fallas de mbx_cmd(). Este error fue encontrado\
    \ por un analizador est\xE1tico. El an\xE1lisis emplea verificaci\xF3n diferencial\
    \ para identificar operaciones de seguridad inconsistentes (por ejemplo, comprobaciones\
    \ o kfrees) entre dos rutas de c\xF3digo y confirma que las operaciones inconsistentes\
    \ no se recuperan en la funci\xF3n actual o en las personas que llaman, por lo\
    \ que constituyen errores. Tenga en cuenta que, como error encontrado mediante\
    \ an\xE1lisis est\xE1tico, puede ser un falso positivo o dif\xEDcil de activar.\
    \ Varios investigadores han realizado una revisi\xF3n cruzada del error. Las compilaciones\
    \ con CONFIG_QLCNIC=m no muestran nuevas advertencias y nuestro analizador est\xE1\
    tico ya no advierte sobre este c\xF3digo."
id: CVE-2021-47542
lastModified: '2024-06-10T18:34:33.073'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-05-24T15:15:18.550'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/15fa12c119f869173f9b710cbe6a4a14071d2105
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3a061d54e260b701b538873b43e399d9b8b83e03
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/550658a2d61e4eaf522c8ebc7fad76dc376bfb45
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/57af54a56024435d83e44c78449513b414eb6edf
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b4f217d6fcc00c3fdc0921a7691f30be7490b073
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/bbeb0325a7460ebf1e03f5e0bfc5c652fba9519f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/c5ef33c1489b2cd74368057fa00b5d2183bb5853
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e2dabc4f7e7b60299c20a36d6a7b24ed9bf8e572
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-476
  source: nvd@nist.gov
  type: Primary
