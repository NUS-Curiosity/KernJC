cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    mptcp: fix sk_forward_memory corruption on retransmission


    MPTCP sk_forward_memory handling is a bit special, as such field

    is protected by the msk socket spin_lock, instead of the plain

    socket lock.


    Currently we have a code path updating such field without handling

    the relevant lock:


    __mptcp_retrans() -> __mptcp_clean_una_wakeup()


    Several helpers in __mptcp_clean_una_wakeup() will update

    sk_forward_alloc, possibly causing such field corruption, as reported

    by Matthieu.


    Address the issue providing and using a new variant of blamed function

    which explicitly acquires the msk spin lock.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mptcp:\
    \ corrige la corrupci\xF3n de sk_forward_memory en la retransmisi\xF3n El manejo\
    \ de MPTCP sk_forward_memory es un poco especial, ya que dicho campo est\xE1 protegido\
    \ por el socket msk spin_lock, en lugar del bloqueo de socket simple. Actualmente\
    \ tenemos una ruta de c\xF3digo que actualiza dicho campo sin manejar el bloqueo\
    \ relevante: __mptcp_retrans() -&gt; __mptcp_clean_una_wakeup() Varios ayudantes\
    \ en __mptcp_clean_una_wakeup() actualizar\xE1n sk_forward_alloc, posiblemente\
    \ causando dicha corrupci\xF3n de campo, seg\xFAn lo informado por Matthieu. Solucione\
    \ el problema proporcionando y utilizando una nueva variante de la funci\xF3n\
    \ culpada que adquiere expl\xEDcitamente el bloqueo de giro msk."
id: CVE-2021-47132
lastModified: '2024-03-17T22:38:29.433'
metrics: {}
published: '2024-03-15T21:15:07.690'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b5941f066b4ca331db225a976dae1d6ca8cf0ae3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/b9c78b1a95966a7bd2ddae05b73eafc0cda4fba3
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
