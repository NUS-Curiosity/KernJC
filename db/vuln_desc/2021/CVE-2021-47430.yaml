descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    x86/entry: Clear X86_FEATURE_SMAP when CONFIG_X86_SMAP=n\n\nCommit\n\n  3c73b81a9164\
    \ (\"x86/entry, selftests: Further improve user entry sanity checks\")\n\nadded\
    \ a warning if AC is set when in the kernel.\n\nCommit\n\n  662a0221893a3d (\"\
    x86/entry: Fix AC assertion\")\n\nchanged the warning to only fire if the CPU\
    \ supports SMAP.\n\nHowever, the warning can still trigger on a machine that supports\
    \ SMAP\nbut where it's disabled in the kernel config and when running the\nsyscall_nt\
    \ selftest, for example:\n\n  ------------[ cut here ]------------\n  WARNING:\
    \ CPU: 0 PID: 49 at irqentry_enter_from_user_mode\n  CPU: 0 PID: 49 Comm: init\
    \ Tainted: G                T 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905\n\
    \  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1\
    \ 04/01/2014\n  RIP: 0010:irqentry_enter_from_user_mode\n  ...\n  Call Trace:\n\
    \   ? irqentry_enter\n   ? exc_general_protection\n   ? asm_exc_general_protection\n\
    \   ? asm_exc_general_protectio\n\nIS_ENABLED(CONFIG_X86_SMAP) could be added\
    \ to the warning condition, but\neven this would not be enough in case SMAP is\
    \ disabled at boot time with\nthe \"nosmap\" parameter.\n\nTo be consistent with\
    \ \"nosmap\" behaviour, clear X86_FEATURE_SMAP when\n!CONFIG_X86_SMAP.\n\nFound\
    \ using entry-fuzz + satrandconfig.\n\n [ bp: Massage commit message. ]"
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: x86/entry:\
    \ borra X86_FEATURE_SMAP cuando CONFIG_X86_SMAP=n confirmaci\xF3n 3c73b81a9164\
    \ (\"x86/entry, selftests: mejora a\xFAn m\xE1s las comprobaciones de seguridad\
    \ de entrada del usuario\") agreg\xF3 una advertencia si AC est\xE1 configurado\
    \ en el n\xFAcleo. La confirmaci\xF3n 662a0221893a3d (\"x86/entry: Reparar aserci\xF3\
    n de AC\") cambi\xF3 la advertencia para que solo se active si la CPU admite SMAP.\
    \ Sin embargo, la advertencia a\xFAn puede activarse en una m\xE1quina que admite\
    \ SMAP pero donde est\xE1 deshabilitado en la configuraci\xF3n del kernel y cuando\
    \ se ejecuta la autoprueba syscall_nt, por ejemplo: ------------[ cortar aqu\xED\
    \ ]--- --------- ADVERTENCIA: CPU: 0 PID: 49 en irqentry_enter_from_user_mode\
    \ CPU: 0 PID: 49 Comm: init Tainted: GT 5.15.0-rc4+ #98 e6202628ee053b4f310759978284bd8bb0ce6905\
    \ Nombre del hardware: PC est\xE1ndar QEMU (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1\
    \ 01/04/2014 RIP: 0010:irqentry_enter_from_user_mode... Seguimiento de llamadas:?\
    \ irqentry_enter? exc_general_protection? asm_exc_general_protection? Se podr\xED\
    a agregar asm_exc_general_protectio IS_ENABLED(CONFIG_X86_SMAP) a la condici\xF3\
    n de advertencia, pero incluso esto no ser\xEDa suficiente en caso de que SMAP\
    \ est\xE9 deshabilitado en el momento del arranque con el par\xE1metro \"nosmap\"\
    . Para ser coherente con el comportamiento de \"nosmap\", borre X86_FEATURE_SMAP\
    \ cuando !CONFIG_X86_SMAP. Encontrado usando Entry-fuzz + satrandconfig. [pb:\
    \ mensaje de confirmaci\xF3n de masaje. ]"
id: CVE-2021-47430
lastModified: '2024-05-21T16:53:56.550'
metrics: {}
published: '2024-05-21T15:15:28.400'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/3958b9c34c2729597e182cc606cc43942fd19f7c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/4e9ec1c65da98c293f75d83755dfa5e03075a6d0
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f2447f6587b8ffe42ba04d14ce67d429a1163e5e
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
