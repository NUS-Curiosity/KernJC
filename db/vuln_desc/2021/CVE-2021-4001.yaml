configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 2AF1DE2C-D6AB-4BB8-B81A-C23986B6D06D
      versionEndIncluding: '5.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:5.16:rc1:*:*:*:*:*:*
      matchCriteriaId: 357AA433-37E8-4323-BFB2-3038D6E4B414
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: A race condition was found in the Linux kernel's ebpf verifier between bpf_map_update_elem
    and bpf_map_freeze due to a missing lock in kernel/bpf/syscall.c. In this flaw,
    a local user with a special privilege (cap_sys_admin or cap_bpf) can modify the
    frozen mapped address space. This flaw affects kernel versions prior to 5.16 rc2.
- lang: es
  value: "Se ha encontrado una condici\xF3n de carrera en el verificador ebpf del\
    \ kernel de Linux entre las funciones bpf_map_update_elem y bpf_map_freeze debido\
    \ a la falta de un bloqueo en el archivo kernel/bpf/syscall.c. En este fallo,\
    \ un usuario local con un privilegio especial (cap_sys_admin o cap_bpf) puede\
    \ modificar el espacio de direcciones mapeado congelado. Este fallo afecta a las\
    \ versiones del kernel anteriores a 5.16 rc2"
id: CVE-2021-4001
lastModified: '2022-11-16T03:36:38.540'
metrics:
  cvssMetricV2:
  - acInsufInfo: false
    baseSeverity: MEDIUM
    cvssData:
      accessComplexity: MEDIUM
      accessVector: LOCAL
      authentication: NONE
      availabilityImpact: NONE
      baseScore: 4.7
      confidentialityImpact: NONE
      integrityImpact: COMPLETE
      vectorString: AV:L/AC:M/Au:N/C:N/I:C/A:N
      version: '2.0'
    exploitabilityScore: 3.4
    impactScore: 6.9
    obtainAllPrivilege: false
    obtainOtherPrivilege: false
    obtainUserPrivilege: false
    source: nvd@nist.gov
    type: Primary
    userInteractionRequired: false
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: NONE
      baseScore: 4.1
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: HIGH
      privilegesRequired: HIGH
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N
      version: '3.1'
    exploitabilityScore: 0.5
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2022-01-21T19:15:09.703'
references:
- source: secalert@redhat.com
  tags:
  - Issue Tracking
  - Patch
  - Third Party Advisory
  url: https://bugzilla.redhat.com/show_bug.cgi?id=2025645
- source: secalert@redhat.com
  tags:
  - Patch
  - Third Party Advisory
  url: https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=353050be4c19e102178ccc05988101887c25ae53
sourceIdentifier: secalert@redhat.com
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-367
  source: nvd@nist.gov
  type: Primary
- description:
  - lang: en
    value: CWE-367
  source: secalert@redhat.com
  type: Secondary
