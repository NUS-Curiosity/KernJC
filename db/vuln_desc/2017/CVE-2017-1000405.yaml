configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: EDF220AE-D4D3-4C0B-BFCA-4DDB897A81FA
      versionEndExcluding: '3.3'
      versionStartIncluding: 3.2.87
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 37623D83-3245-418B-AA79-7FFB56124AAB
      versionEndExcluding: '3.11'
      versionStartIncluding: 3.10.106
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: AB8D1C8F-5DE4-4255-B35E-85BEE71D518A
      versionEndExcluding: '3.13'
      versionStartIncluding: 3.12.73
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6D8C2C4B-81CA-4D5D-9B18-6D93FC1B1B5B
      versionEndExcluding: 3.16.52
      versionStartIncluding: 3.16.42
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: B38F58F2-22F3-41A2-B43D-FD9027FD2A7D
      versionEndExcluding: 3.18.86
      versionStartIncluding: 3.18.55
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 871C0EA3-24B8-4D57-A72C-42F66AEED6D0
      versionEndExcluding: 4.1.48
      versionStartIncluding: 4.1.41
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FCBEC938-9743-47A8-B536-D7B935A453A3
      versionEndExcluding: 4.4.104
      versionStartIncluding: 4.4.70
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 1D4E9DE9-EA55-48F6-88BB-DBF18E65D76A
      versionEndExcluding: 4.9.67
      versionStartIncluding: 4.9.7
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 526A67F6-8D42-4C55-99BE-B68231777244
      versionEndExcluding: 4.14.4
      versionStartIncluding: '4.10'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: The Linux Kernel versions 2.6.38 through 4.14 have a problematic use of pmd_mkdirty()
    in the touch_pmd() function inside the THP implementation. touch_pmd() can be
    reached by get_user_pages(). In such case, the pmd will become dirty. This scenario
    breaks the new can_follow_write_pmd()'s logic - pmd can become dirty without going
    through a COW cycle. This bug is not as severe as the original "Dirty cow" because
    an ext4 file (or any other regular file) cannot be mapped using THP. Nevertheless,
    it does allow us to overwrite read-only huge pages. For example, the zero huge
    page and sealed shmem files can be overwritten (since their mapping can be populated
    using THP). Note that after the first write page-fault to the zero page, it will
    be replaced with a new fresh (and zeroed) thp.
- lang: es
  value: "El kernel de Linux desde la versi\xF3n 2.6.38 hasta la 4.14 presenta un\
    \ uso problem\xE1tico de pmd_mkdirty() en la funci\xF3n touch_pmd() dentro de\
    \ la implementaci\xF3n THP. Se puede llegar a touch_pmd() con get_user_pages().\
    \ En ese caso, el pmd se ensuciar\xEDa. Este escenario rompe la nueva l\xF3gica\
    \ de can_follow_write_pmd(). pmd puede contaminarse sin pasar por un ciclo COW.\
    \ Este fallo no es tan severo como el error original \"Dirty COW\" porque un archivo\
    \ ext4 (o cualquier otro archivo normal) no puede ser mapeado usando THP. Sin\
    \ embargo, permite sobrescribir huge pages de solo lectura. Por ejemplo, los archivos\
    \ shmem sellados y huge pages con ceros pueden sobrescribirse (ya que se pueden\
    \ mapear con THP). Tenga en cuenta que despu\xE9s del primer error de escritura\
    \ de p\xE1gina en la p\xE1gina con cero, se reemplazar\xE1 por un nuevo thp (y\
    \ con ceros)."
id: CVE-2017-1000405
lastModified: '2023-06-26T16:55:42.617'
metrics:
  cvssMetricV2:
  - acInsufInfo: false
    baseSeverity: MEDIUM
    cvssData:
      accessComplexity: MEDIUM
      accessVector: LOCAL
      authentication: NONE
      availabilityImpact: COMPLETE
      baseScore: 6.9
      confidentialityImpact: COMPLETE
      integrityImpact: COMPLETE
      vectorString: AV:L/AC:M/Au:N/C:C/I:C/A:C
      version: '2.0'
    exploitabilityScore: 3.4
    impactScore: 10.0
    obtainAllPrivilege: false
    obtainOtherPrivilege: false
    obtainUserPrivilege: false
    source: nvd@nist.gov
    type: Primary
    userInteractionRequired: false
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.0
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.0
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2017-11-30T22:29:00.217'
references:
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  - VDB Entry
  url: http://www.securityfocus.com/bid/102032
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  - VDB Entry
  url: http://www.securitytracker.com/id/1040020
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2018:0180
- source: cve@mitre.org
  tags:
  - Exploit
  - Issue Tracking
  - Third Party Advisory
  url: https://medium.com/bindecy/huge-dirty-cow-cve-2017-1000405-110eca132de0
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://source.android.com/security/bulletin/pixel/2018-02-01
- source: cve@mitre.org
  tags:
  - Exploit
  - Issue Tracking
  - Third Party Advisory
  - VDB Entry
  url: https://www.exploit-db.com/exploits/43199/
sourceIdentifier: cve@mitre.org
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-362
  source: nvd@nist.gov
  type: Primary
