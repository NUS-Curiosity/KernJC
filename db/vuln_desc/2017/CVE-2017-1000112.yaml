configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C3FE348E-5745-49CF-B0F6-52AA3E4F3A42
      versionEndExcluding: 3.10.108
      versionStartIncluding: 2.6.15
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 1B863019-9BE4-4D3F-907A-B5BFDEEE975E
      versionEndExcluding: 3.16.47
      versionStartIncluding: '3.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 15A3222E-681C-4561-B7DF-C1D36FE3773C
      versionEndExcluding: 3.18.65
      versionStartIncluding: '3.17'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: BCC5E165-3BA3-42E8-A9B4-BAC5C9C90365
      versionEndExcluding: 4.4.82
      versionStartIncluding: '3.19'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FE7B437E-2829-4956-BBB4-79F150CABB0C
      versionEndExcluding: 4.9.43
      versionStartIncluding: '4.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9186C944-947B-4F51-8956-925591EFF822
      versionEndExcluding: 4.12.7
      versionStartIncluding: '4.10'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch.
    When building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data()
    to append. However in between two send() calls, the append path can be switched
    from UFO to non-UFO one, which leads to a memory corruption. In case UFO packet
    lengths exceeds MTU, copy = maxfraglen - skb->len becomes negative on the non-UFO
    path and the branch to allocate new skb is taken. This triggers fragmentation
    and computation of fraggap = skb_prev->len - maxfraglen. Fraggap can exceed MTU,
    causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently
    skb_copy_and_csum_bits() writes out-of-bounds. A similar issue is present in IPv6
    code. The bug was introduced in e89e9cf539a2 ("[IPv4/IPv6]: UFO Scatter-gather
    approach") on Oct 18 2005.'
- lang: es
  value: "Linux kernel: Existe una corrupci\xF3n de memoria explotable debida al cambio\
    \ de ruta de UFO a no UFO. Al crear un paquete UFO con MSG_MORE, __ip_append_data()\
    \ llama a ip_ufo_append_data() para que se anexe. Sin embargo, entre dos llamadas\
    \ send(), la ruta anexa puede cambiarse de UFO a no UFO, lo que lleva a una corrupci\xF3\
    n de memoria. Si la longitud del paquete UFO sobrepasa el MTU, copy = maxfraglen\
    \ - skb->len se convierte en negativo en la ruta no UFO y se toma una rama para\
    \ asignar un nuevo skb. Esto desencadena la fragmentaci\xF3n y el c\xE1lculo de\
    \ fraggap = skb_prev->len - maxfraglen. fraggap puede exceder el MTU, lo que provoca\
    \ que copy = datalen - transhdrlen - fraggap se vuelva negativo. En consecuencia,\
    \ skb_copy_and_csum_bits() escribe fuera de l\xEDmites. Existe un problema similar\
    \ en el c\xF3digo IPv6. Este error fue introducido en e89e9cf539a2 (\"[IPv4/IPv6]:\
    \ UFO Scatter-gather approach\") el 18 de octubre de 2005."
id: CVE-2017-1000112
lastModified: '2023-06-07T12:46:19.047'
metrics:
  cvssMetricV2:
  - acInsufInfo: false
    baseSeverity: MEDIUM
    cvssData:
      accessComplexity: MEDIUM
      accessVector: LOCAL
      authentication: NONE
      availabilityImpact: COMPLETE
      baseScore: 6.9
      confidentialityImpact: COMPLETE
      integrityImpact: COMPLETE
      vectorString: AV:L/AC:M/Au:N/C:C/I:C/A:C
      version: '2.0'
    exploitabilityScore: 3.4
    impactScore: 10.0
    obtainAllPrivilege: false
    obtainOtherPrivilege: false
    obtainUserPrivilege: false
    source: nvd@nist.gov
    type: Primary
    userInteractionRequired: false
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.0
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.0
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2017-10-05T01:29:04.477'
references:
- source: cve@mitre.org
  tags:
  - Mailing List
  - Patch
  - Third Party Advisory
  url: http://seclists.org/oss-sec/2017/q3/277
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: http://www.debian.org/security/2017/dsa-3981
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  - VDB Entry
  url: http://www.securityfocus.com/bid/100262
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  - VDB Entry
  url: http://www.securitytracker.com/id/1039162
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2017:2918
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2017:2930
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2017:2931
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2017:3200
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2019:1931
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2019:1932
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://access.redhat.com/errata/RHSA-2019:4159
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  url: https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-1000112
- source: cve@mitre.org
  tags:
  - Third Party Advisory
  - VDB Entry
  url: https://www.exploit-db.com/exploits/45147/
sourceIdentifier: cve@mitre.org
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-362
  source: nvd@nist.gov
  type: Primary
