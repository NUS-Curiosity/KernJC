configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0799BB5F-A0F0-4290-872D-24364C18F638
      versionEndExcluding: 4.19.317
      versionStartIncluding: 4.19.272
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 4821FCF8-B57B-4F3C-B3FC-5CFAEA2C6BC5
      versionEndExcluding: 5.4.279
      versionStartIncluding: 5.4.231
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E81DAF77-0E91-457C-AC9D-117B2D0BF7CB
      versionEndExcluding: 5.10.221
      versionStartIncluding: 5.10.166
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 2E0E5DA0-5043-4127-8316-B0E03B88EE6E
      versionEndExcluding: 5.15.162
      versionStartIncluding: 5.15.91
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 012144F5-2368-4D39-ABE2-07E7568304BB
      versionEndExcluding: 6.1.96
      versionStartIncluding: 6.1.9
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E1046C95-860A-45B0-B718-2B29F65BFF10
      versionEndExcluding: 6.6.36
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0A047AF2-94AC-4A3A-B32D-6AB930D8EF1C
      versionEndExcluding: 6.9.7
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
      matchCriteriaId: 2EBB4392-5FA6-4DA9-9772-8F9C750109FA
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
      matchCriteriaId: 331C2F14-12C7-45D5-893D-8C52EE38EA10
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
      matchCriteriaId: 3173713D-909A-4DD3-9DD4-1E171EB057EE
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
      matchCriteriaId: 79F18AFA-40F7-43F0-BA30-7BDB65F918B9
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    netrom: Fix a memory leak in nr_heartbeat_expiry()\n\nsyzbot reported a memory\
    \ leak in nr_create() [0].\n\nCommit 409db27e3a2e (\"netrom: Fix use-after-free\
    \ of a listening socket.\")\nadded sock_hold() to the nr_heartbeat_expiry() function,\
    \ where\na) a socket has a SOCK_DESTROY flag or\nb) a listening socket has a SOCK_DEAD\
    \ flag.\n\nBut in the case \"a,\" when the SOCK_DESTROY flag is set, the file\
    \ descriptor\nhas already been closed and the nr_release() function has been called.\n\
    So it makes no sense to hold the reference count because no one will\ncall another\
    \ nr_destroy_socket() and put it as in the case \"b.\"\n\nnr_connect\n  nr_establish_data_link\n\
    \    nr_start_heartbeat\n\nnr_release\n  switch (nr->state)\n  case NR_STATE_3\n\
    \    nr->state = NR_STATE_2\n    sock_set_flag(sk, SOCK_DESTROY);\n\n        \
    \                nr_rx_frame\n                          nr_process_rx_frame\n\
    \                            switch (nr->state)\n                            case\
    \ NR_STATE_2\n                              nr_state2_machine()\n            \
    \                    nr_disconnect()\n                                  nr_sk(sk)->state\
    \ = NR_STATE_0\n                                  sock_set_flag(sk, SOCK_DEAD)\n\
    \n                        nr_heartbeat_expiry\n                          switch\
    \ (nr->state)\n                          case NR_STATE_0\n                   \
    \         if (sock_flag(sk, SOCK_DESTROY) ||\n                               (sk->sk_state\
    \ == TCP_LISTEN\n                                 && sock_flag(sk, SOCK_DEAD)))\n\
    \                               sock_hold()  // ( !!! )\n                    \
    \           nr_destroy_socket()\n\nTo fix the memory leak, let's call sock_hold()\
    \ only for a listening socket.\n\nFound by InfoTeCS on behalf of Linux Verification\
    \ Center\n(linuxtesting.org) with Syzkaller.\n\n[0]: https://syzkaller.appspot.com/bug?extid=d327a1f3b12e1e206c16"
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: netrom:\
    \ corrige una p\xE9rdida de memoria en nr_heartbeat_expiry() syzbot inform\xF3\
    \ una p\xE9rdida de memoria en nr_create() [0]. El commit 409db27e3a2e (\"netrom:\
    \ Reparar el use-after-free de un socket de escucha\") agreg\xF3 sock_hold() a\
    \ la funci\xF3n nr_heartbeat_expiry(), donde a) un socket tiene un indicador SOCK_DESTROY\
    \ ob) un socket de escucha tiene un indicador SOCK_DEAD. Pero en el caso \"a\"\
    , cuando se establece el indicador SOCK_DESTROY, el descriptor de archivo ya se\
    \ ha cerrado y se ha llamado a la funci\xF3n nr_release(). Por lo tanto, no tiene\
    \ sentido mantener el recuento de referencias porque nadie llamar\xE1 a otro nr_destroy_socket()\
    \ y lo pondr\xE1 como en el caso \"b\". nr_connect nr_establecer_data_link nr_start_heartbeat\
    \ nr_release interruptor (nr-&gt;estado) caso NR_STATE_3 nr-&gt;estado = NR_STATE_2\
    \ sock_set_flag(sk, SOCK_DESTROY); nr_rx_frame nr_process_rx_frame interruptor\
    \ (nr-&gt;estado) caso NR_STATE_2 nr_state2_machine() nr_disconnect() nr_sk(sk)-&gt;estado\
    \ = NR_STATE_0 sock_set_flag(sk, SOCK_DEAD) nr_heartbeat_expiry interruptor (nr-&gt;estado)\
    \ caso NR_STATE_0 if (sock_flag(sk, OCK_DESTROY) || (sk-&gt;sk_state == TCP_LISTEN\
    \ &amp;&amp; sock_flag(sk, SOCK_DEAD))) sock_hold() // ( !!! ) nr_destroy_socket()\
    \ Para solucionar la p\xE9rdida de memoria, llamemos a sock_hold() solo para un\
    \ socket de escucha. Encontrado por InfoTeCS en nombre del Centro de verificaci\xF3\
    n de Linux (linuxtesting.org) con Syzkaller. [0]: https://syzkaller.appspot.com/bug?extid=d327a1f3b12e1e206c16"
id: CVE-2024-41006
lastModified: '2024-08-21T17:20:57.467'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-12T13:15:21.370'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/0b9130247f3b6a1122478471ff0e014ea96bb735
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/280cf1173726a7059b628c610c71050d5c0b6937
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/5391f9db2cab5ef1cb411be1ab7dbec728078fba
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/a02fd5d775cf9787ee7698c797e20f2fa13d2e2b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/b6ebe4fed73eedeb73f4540f8edc4871945474c8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/d377f5a28332954b19e373d36823e59830ab1712
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/d616876256b38ecf9a1a1c7d674192c5346bc69c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/e07a9c2a850cdebf625e7a1b8171bd23a8554313
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-401
  source: nvd@nist.gov
  type: Primary
