configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: BC2B5B53-6D0E-4FA7-B414-71D3FF089CAA
      versionEndExcluding: 6.1.101
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 972274A2-D688-4C37-BE42-689B58B4C225
      versionEndExcluding: 6.6.42
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 01E300B3-8B39-4A2D-8B03-4631433D3915
      versionEndExcluding: 6.9.11
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
      matchCriteriaId: 2EBB4392-5FA6-4DA9-9772-8F9C750109FA
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
      matchCriteriaId: 331C2F14-12C7-45D5-893D-8C52EE38EA10
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
      matchCriteriaId: 3173713D-909A-4DD3-9DD4-1E171EB057EE
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
      matchCriteriaId: 79F18AFA-40F7-43F0-BA30-7BDB65F918B9
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
      matchCriteriaId: BD973AA4-A789-49BD-8D57-B2846935D3C7
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    ibmvnic: Add tx check to prevent skb leak\n\nBelow is a summary of how the driver\
    \ stores a reference to an skb during\ntransmit:\n    tx_buff[free_map[consumer_index]]->skb\
    \ = new_skb;\n    free_map[consumer_index] = IBMVNIC_INVALID_MAP;\n    consumer_index\
    \ ++;\nWhere variable data looks like this:\n    free_map == [4, IBMVNIC_INVALID_MAP,\
    \ IBMVNIC_INVALID_MAP, 0, 3]\n                                               \t\
    consumer_index^\n    tx_buff == [skb=null, skb=<ptr>, skb=<ptr>, skb=null, skb=null]\n\
    \nThe driver has checks to ensure that free_map[consumer_index] pointed to\na\
    \ valid index but there was no check to ensure that this index pointed\nto an\
    \ unused/null skb address. So, if, by some chance, our free_map and\ntx_buff lists\
    \ become out of sync then we were previously risking an\nskb memory leak. This\
    \ could then cause tcp congestion control to stop\nsending packets, eventually\
    \ leading to ETIMEDOUT.\n\nTherefore, add a conditional to ensure that the skb\
    \ address is null. If\nnot then warn the user (because this is still a bug that\
    \ should be\npatched) and free the old pointer to prevent memleak/tcp problems."
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: ibmvnic:\
    \ agregue verificaci\xF3n de tx para evitar fugas de skb A continuaci\xF3n se\
    \ muestra un resumen de c\xF3mo el controlador almacena una referencia a un skb\
    \ durante la transmisi\xF3n: tx_buff[free_map[consumer_index]]-&gt;skb = new_skb\
    \ ; free_map[consumer_index] = IBMVNIC_INVALID_MAP; consumer_index++; Donde los\
    \ datos variables se ven as\xED: free_map == [4, IBMVNIC_INVALID_MAP, IBMVNIC_INVALID_MAP,\
    \ 0, 3] consumer_index^ tx_buff == [skb=null, skb=, skb=, skb=null, skb=null ]\
    \ El controlador tiene comprobaciones para garantizar que free_map[consumer_index]\
    \ apunte a un \xEDndice v\xE1lido, pero no hubo ninguna verificaci\xF3n para garantizar\
    \ que este \xEDndice apunte a una direcci\xF3n skb nula o no utilizada. Entonces,\
    \ si, por casualidad, nuestras listas free_map y tx_buff no est\xE1n sincronizadas,\
    \ entonces est\xE1bamos arriesg\xE1ndonos a una p\xE9rdida de memoria skb. Esto\
    \ podr\xEDa provocar que el control de congesti\xF3n de TCP deje de enviar paquetes,\
    \ lo que eventualmente provocar\xEDa ETIMEDOUT. Por lo tanto, agregue un condicional\
    \ para garantizar que la direcci\xF3n skb sea nula. De lo contrario, advierta\
    \ al usuario (porque todav\xEDa es un error que debe corregirse) y libere el puntero\
    \ antiguo para evitar problemas de memleak/tcp."
id: CVE-2024-41066
lastModified: '2024-09-10T17:06:26.617'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-29T15:15:14.480'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0983d288caf984de0202c66641577b739caad561
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/16ad1557cae582e79bb82dddd612d9bdfaa11d4c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/267c61c4afed0ff9a2e83462abad3f41d8ca1f06
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e7b75def33eae61ddaad6cb616c517dc3882eb2a
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-401
  source: nvd@nist.gov
  type: Primary
