configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 43E390F8-BDB4-4990-B94D-095DD8369C31
      versionEndExcluding: 4.19.318
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 625DBFAB-C3D0-4309-A27F-12D6428FB38F
      versionEndExcluding: 5.4.280
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 00696AC5-EE29-437F-97F9-C4D66608B327
      versionEndExcluding: 5.10.222
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A97DEB09-4927-40F8-B5C6-F5BD5EAE0CFD
      versionEndExcluding: 5.15.163
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E09E92A5-27EF-40E4-926A-B1CDC8270551
      versionEndExcluding: 6.1.98
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 29E894E4-668F-4DB0-81F7-4FB5F698E970
      versionEndExcluding: 6.6.39
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ADCC1407-0CB3-4C8F-B4C5-07F682CD7085
      versionEndExcluding: 6.9.9
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    nilfs2: add missing check for inode numbers on directory entries


    Syzbot reported that mounting and unmounting a specific pattern of

    corrupted nilfs2 filesystem images causes a use-after-free of metadata

    file inodes, which triggers a kernel bug in lru_add_fn().


    As Jan Kara pointed out, this is because the link count of a metadata file

    gets corrupted to 0, and nilfs_evict_inode(), which is called from iput(),

    tries to delete that inode (ifile inode in this case).


    The inconsistency occurs because directories containing the inode numbers

    of these metadata files that should not be visible in the namespace are

    read without checking.


    Fix this issue by treating the inode numbers of these internal files as

    errors in the sanity check helper when reading directory folios/pages.


    Also thanks to Hillf Danton and Matthew Wilcox for their initial mm-layer

    analysis.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: nilfs2:\
    \ agrega una verificaci\xF3n faltante para los n\xFAmeros de inodo en las entradas\
    \ del directorio Syzbot inform\xF3 que montar y desmontar un patr\xF3n espec\xED\
    fico de im\xE1genes corruptas del sistema de archivos nilfs2 provoca un use after\
    \ free de los inodos del archivo de metadatos, lo que desencadena un error del\
    \ kernel en lru_add_fn(). Como se\xF1al\xF3 Jan Kara, esto se debe a que el recuento\
    \ de enlaces de un archivo de metadatos se corrompe a 0, y nilfs_evict_inode(),\
    \ que se llama desde iput(), intenta eliminar ese inodo (inodo ifile en este caso).\
    \ La inconsistencia se produce porque los directorios que contienen los n\xFA\
    meros de inodo de estos archivos de metadatos que no deber\xEDan ser visibles\
    \ en el espacio de nombres se leen sin verificar. Solucione este problema tratando\
    \ los n\xFAmeros de inodo de estos archivos internos como errores en el asistente\
    \ de verificaci\xF3n de cordura al leer folios/p\xE1ginas del directorio. Tambi\xE9\
    n gracias a Hillf Danton y Matthew Wilcox por su an\xE1lisis inicial de capas\
    \ mm."
id: CVE-2024-42104
lastModified: '2024-08-27T14:28:28.023'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-07-30T08:15:02.900'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/07c176e7acc5579c133bb923ab21316d192d0a95
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1b7d549ed2c1fa202c751b69423a0d3a6bd5a180
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/265fff1a01cdc083aeaf0d934c929db5cc64aebf
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2f2fa9cf7c3537958a82fbe8c8595a5eb0861ad7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3ab40870edb883b9633dc5cd55f5a2a11afa618d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b11e8fb93ea5eefb2e4e719497ea177a58ff6131
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/bb76c6c274683c8570ad788f79d4b875bde0e458
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/c33c2b0d92aa1c2262d999b2598ad6fbd53bd479
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
