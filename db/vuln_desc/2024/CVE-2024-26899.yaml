configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9B95D3A6-E162-47D5-ABFC-F3FA74FA7CFD
      versionEndExcluding: 6.7.11
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 543A75FF-25B8-4046-A514-1EA8EDD87AB1
      versionEndExcluding: 6.8.2
      versionStartIncluding: '6.8'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    block: fix deadlock between bd_link_disk_holder and partition scan\n\n'open_mutex'\
    \ of gendisk is used to protect open/close block devices. But\nin bd_link_disk_holder(),\
    \ it is used to protect the creation of symlink\nbetween holding disk and slave\
    \ bdev, which introduces some issues.\n\nWhen bd_link_disk_holder() is called,\
    \ the driver is usually in the process\nof initialization/modification and may\
    \ suspend submitting io. At this\ntime, any io hold 'open_mutex', such as scanning\
    \ partitions, can cause\ndeadlocks. For example, in raid:\n\nT1              \
    \                T2\nbdev_open_by_dev\n lock open_mutex [1]\n ...\n  efi_partition\n\
    \  ...\n   md_submit_bio\n\t\t\t\tmd_ioctl mddev_syspend\n\t\t\t\t  -> suspend\
    \ all io\n\t\t\t\t md_add_new_disk\n\t\t\t\t  bind_rdev_to_array\n\t\t\t\t   bd_link_disk_holder\n\
    \t\t\t\t    try lock open_mutex [2]\n    md_handle_request\n     -> wait mddev_resume\n\
    \nT1 scan partition, T2 add a new device to raid. T1 waits for T2 to resume\n\
    mddev, but T2 waits for open_mutex held by T1. Deadlock occurs.\n\nFix it by introducing\
    \ a local mutex 'blk_holder_mutex' to replace\n'open_mutex'."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: bloque:\
    \ soluciona el punto muerto entre bd_link_disk_holder y el an\xE1lisis de partici\xF3\
    n. 'open_mutex' de gendisk se utiliza para proteger dispositivos de bloqueo de\
    \ apertura/cierre. Pero en bd_link_disk_holder(), se utiliza para proteger la\
    \ creaci\xF3n de un enlace simb\xF3lico entre el disco de retenci\xF3n y el bdev\
    \ esclavo, lo que introduce algunos problemas. Cuando se llama a bd_link_disk_holder(),\
    \ el controlador generalmente est\xE1 en el proceso de inicializaci\xF3n/modificaci\xF3\
    n y puede suspender el env\xEDo de io. En este momento, cualquier retenci\xF3\
    n de io 'open_mutex', como escanear particiones, puede causar interbloqueos. Por\
    \ ejemplo, en raid: T1 T2 bdev_open_by_dev lock open_mutex [1] ... efi_partition\
    \ ... md_submit_bio md_ioctl mddev_syspend -&gt; suspender todo io md_add_new_disk\
    \ bind_rdev_to_array bd_link_disk_holder try lock open_mutex [2] md_handle_request\
    \ -&gt; esperar mddev_resume T1 escanear partici\xF3n, agregar un Nuevo dispositivo\
    \ para atacar. T1 espera a que T2 reanude mddev, pero T2 espera a open_mutex retenido\
    \ por T1. Se produce un punto muerto. Solucionarlo introduciendo un mutex local\
    \ 'blk_holder_mutex' para reemplazar 'open_mutex'."
id: CVE-2024-26899
lastModified: '2024-04-29T19:34:10.080'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-04-17T11:15:10.870'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/03f12122b20b6e6028e9ed69030a49f9cffcbb75
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1e5c5b0abaee7b62a10b9707a62083b71ad21f62
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5a87c1f7993bc8ac358a3766bac5dc7126e01e98
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-667
  source: nvd@nist.gov
  type: Primary
