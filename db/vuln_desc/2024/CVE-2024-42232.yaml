configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 43E390F8-BDB4-4990-B94D-095DD8369C31
      versionEndExcluding: 4.19.318
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 625DBFAB-C3D0-4309-A27F-12D6428FB38F
      versionEndExcluding: 5.4.280
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 00696AC5-EE29-437F-97F9-C4D66608B327
      versionEndExcluding: 5.10.222
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A97DEB09-4927-40F8-B5C6-F5BD5EAE0CFD
      versionEndExcluding: 5.15.163
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 100CDF74-4DB5-4FC6-A54B-BDBDB0C27137
      versionEndExcluding: 6.1.100
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 96AC42B8-D66D-4AC5-B466-E9BA7910FA29
      versionEndExcluding: 6.6.41
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: AB2E8DEC-CFD5-4C2B-981D-E7E45A36C352
      versionEndExcluding: 6.9.10
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    libceph: fix race between delayed_work() and ceph_monc_stop()\n\nThe way the delayed\
    \ work is handled in ceph_monc_stop() is prone to\nraces with mon_fault() and\
    \ possibly also finish_hunting().  Both of\nthese can requeue the delayed work\
    \ which wouldn't be canceled by any of\nthe following code in case that happens\
    \ after cancel_delayed_work_sync()\nruns -- __close_session() doesn't mess with\
    \ the delayed work in order\nto avoid interfering with the hunting interval logic.\
    \  This part was\nmissed in commit b5d91704f53e (\"libceph: behave in mon_fault()\
    \ if\ncur_mon < 0\") and use-after-free can still ensue on monc and objects\n\
    that hang off of it, with monc->auth and monc->monmap being\nparticularly susceptible\
    \ to quickly being reused.\n\nTo fix this:\n\n- clear monc->cur_mon and monc->hunting\
    \ as part of closing the session\n  in ceph_monc_stop()\n- bail from delayed_work()\
    \ if monc->cur_mon is cleared, similar to how\n  it's done in mon_fault() and\
    \ finish_hunting() (based on monc->hunting)\n- call cancel_delayed_work_sync()\
    \ after the session is closed"
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: libceph:\
    \ corrige la ejecuci\xF3n entre retardado_work() y ceph_monc_stop() La forma en\
    \ que se maneja el trabajo retrasado en ceph_monc_stop() es propensa a ejecuci\xF3\
    ns con mon_fault() y posiblemente tambi\xE9n con Finish_hunting(). Ambos pueden\
    \ volver a poner en cola el trabajo retrasado que no ser\xEDa cancelado por ninguno\
    \ de los siguientes c\xF3digos en caso de que eso suceda despu\xE9s de que se\
    \ ejecute cancel_delayed_work_sync() - __close_session() no interfiere con el\
    \ trabajo retrasado para evitar interferir con la b\xFAsqueda l\xF3gica de intervalo.\
    \ Esta parte se omiti\xF3 en el commit b5d91704f53e (\"libceph: comportarse en\
    \ mon_fault() si cur_mon &lt; 0\") y el use-after-free a\xFAn puede producirse\
    \ en monc y los objetos que cuelgan de \xE9l, con monc-&gt;auth y monc-&gt; monmap\
    \ es particularmente susceptible de ser reutilizado r\xE1pidamente. Para solucionar\
    \ esto: - borre monc-&gt;cur_mon y monc-&gt;hunting como parte del cierre de la\
    \ sesi\xF3n en ceph_monc_stop() - libere de delay_work() si monc-&gt;cur_mon est\xE1\
    \ borrado, similar a como se hace en mon_fault() y Finish_hunting () (basado en\
    \ monc-&gt;hunting): llame a cancel_delayed_work_sync() despu\xE9s de cerrar la\
    \ sesi\xF3n"
id: CVE-2024-42232
lastModified: '2024-08-08T15:02:09.750'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-08-07T16:15:46.213'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1177afeca833174ba83504688eec898c6214f4bf
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/20cf67dcb7db842f941eff1af6ee5e9dc41796d7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2d33654d40a05afd91ab24c9a73ab512a0670a9a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/33d38c5da17f8db2d80e811b7829d2822c10625e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/34b76d1922e41da1fa73d43b764cddd82ac9733c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/63e5d035e3a7ab7412a008f202633c5e6a0a28ea
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/69c7b2fe4c9cc1d3b1186d1c5606627ecf0de883
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/9525af1f58f67df387768770fcf6d6a8f23aee3d
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
