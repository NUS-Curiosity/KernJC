configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 4FE032DD-45DE-45DB-86F3-04D82172342D
      versionEndExcluding: 4.19.313
      versionStartIncluding: '3.8'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 5FF6D8DE-C559-4586-86C8-2C6B4420A2C2
      versionEndExcluding: 5.4.275
      versionStartIncluding: '4.20'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A44ABF89-F1BD-4C9A-895D-7596650DCD27
      versionEndExcluding: 5.10.216
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 65D80EF6-76AF-4186-B680-55516EA42EED
      versionEndExcluding: 5.15.158
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 59CEDDCF-5C0D-4939-9CFE-2F4524892DD3
      versionEndExcluding: 6.1.90
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 84046DAF-73CF-429D-9BA4-05B658B377B5
      versionEndExcluding: 6.6.30
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 5F9041E5-8358-4EF7-8F98-B812EDE49612
      versionEndExcluding: 6.8.9
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    HID: i2c-hid: remove I2C_HID_READ_PENDING flag to prevent lock-up


    The flag I2C_HID_READ_PENDING is used to serialize I2C operations.

    However, this is not necessary, because I2C core already has its own

    locking for that.


    More importantly, this flag can cause a lock-up: if the flag is set in

    i2c_hid_xfer() and an interrupt happens, the interrupt handler

    (i2c_hid_irq) will check this flag and return immediately without doing

    anything, then the interrupt handler will be invoked again in an

    infinite loop.


    Since interrupt handler is an RT task, it takes over the CPU and the

    flag-clearing task never gets scheduled, thus we have a lock-up.


    Delete this unnecessary flag.'
- lang: es
  value: " En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: HID:\
    \ i2c-hid: elimine el indicador I2C_HID_READ_PENDING para evitar el bloqueo. El\
    \ indicador I2C_HID_READ_PENDING se utiliza para serializar operaciones I2C. Sin\
    \ embargo, esto no es necesario, porque el n\xFAcleo I2C ya tiene su propio bloqueo\
    \ para ello. M\xE1s importante a\xFAn, este indicador puede causar un bloqueo:\
    \ si el indicador est\xE1 configurado en i2c_hid_xfer() y ocurre una interrupci\xF3\
    n, el controlador de interrupciones (i2c_hid_irq) verificar\xE1 este indicador\
    \ y regresar\xE1 inmediatamente sin hacer nada, entonces se invocar\xE1 el controlador\
    \ de interrupciones. nuevamente en un bucle infinito. Dado que el controlador\
    \ de interrupciones es una tarea RT, se hace cargo de la CPU y la tarea de limpieza\
    \ de banderas nunca se programa, por lo que tenemos un bloqueo. Elimine esta bandera\
    \ innecesaria."
id: CVE-2024-35997
lastModified: '2024-06-25T23:15:31.750'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-05-20T10:15:13.960'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0561b65fbd53d3e788c5b0222d9112ca016fd6a1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/21bfca822cfc1e71796124e93b46e0d9fa584401
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/29e94f295bad5be59cf4271a93e22cdcf5536722
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/418c5575d56410c6e186ab727bf32ae32447d497
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5095b93021b899f54c9355bebf36d78854c33a22
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/9c0f59e47a90c54d0153f8ddc0f80d7a36207d0e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b65fb50e04a95eec34a9d1bc138454a98a5578d8
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/c448a9fd50f77e8fb9156ff64848aa4295eb3003
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-667
  source: nvd@nist.gov
  type: Primary
