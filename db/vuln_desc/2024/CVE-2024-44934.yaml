configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: F3BF38C6-4F30-4588-B942-87545E62CA7D
      versionEndExcluding: 5.15.165
      versionStartIncluding: '5.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 89BEB24B-0F37-4C92-A397-564DA7CD8EE9
      versionEndExcluding: 6.1.105
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FA11941E-81FB-484C-B583-881EEB488340
      versionEndExcluding: 6.6.46
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D074AE50-4A5E-499C-A2FD-75FD60DEA560
      versionEndExcluding: 6.10.5
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
      matchCriteriaId: 8B3CE743-2126-47A3-8B7C-822B502CF119
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
      matchCriteriaId: 4DEB27E7-30AA-45CC-8934-B89263EF3551
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    net: bridge: mcast: wait for previous gc cycles when removing port\n\nsyzbot hit\
    \ a use-after-free[1] which is caused because the bridge doesn't\nmake sure that\
    \ all previous garbage has been collected when removing a\nport. What happens\
    \ is:\n      CPU 1                   CPU 2\n start gc cycle           remove port\n\
    \                         acquire gc lock first\n wait for lock\n            \
    \             call br_multicasg_gc() directly\n acquire lock now but    free port\n\
    \ the port can be freed\n while grp timers still\n running\n\nMake sure all previous\
    \ gc cycles have finished by using flush_work before\nfreeing the port.\n\n[1]\n\
    \  BUG: KASAN: slab-use-after-free in br_multicast_port_group_expired+0x4c0/0x550\
    \ net/bridge/br_multicast.c:861\n  Read of size 8 at addr ffff888071d6d000 by\
    \ task syz.5.1232/9699\n\n  CPU: 1 PID: 9699 Comm: syz.5.1232 Not tainted 6.10.0-rc5-syzkaller-00021-g24ca36a562d6\
    \ #0\n  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS\
    \ Google 06/07/2024\n  Call Trace:\n   <IRQ>\n   __dump_stack lib/dump_stack.c:88\
    \ [inline]\n   dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c:114\n   print_address_description\
    \ mm/kasan/report.c:377 [inline]\n   print_report+0xc3/0x620 mm/kasan/report.c:488\n\
    \   kasan_report+0xd9/0x110 mm/kasan/report.c:601\n   br_multicast_port_group_expired+0x4c0/0x550\
    \ net/bridge/br_multicast.c:861\n   call_timer_fn+0x1a3/0x610 kernel/time/timer.c:1792\n\
    \   expire_timers kernel/time/timer.c:1843 [inline]\n   __run_timers+0x74b/0xaf0\
    \ kernel/time/timer.c:2417\n   __run_timer_base kernel/time/timer.c:2428 [inline]\n\
    \   __run_timer_base kernel/time/timer.c:2421 [inline]\n   run_timer_base+0x111/0x190\
    \ kernel/time/timer.c:2437"
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: net:\
    \ bridge: mcast: espere los ciclos de gc anteriores al eliminar el puerto syzbot\
    \ alcanz\xF3 un use-after-free [1] que se debe a que el puente no se asegura de\
    \ que todos Se ha recogido basura anterior al eliminar un puerto. Lo que sucede\
    \ es: CPU 1 CPU 2 iniciar el ciclo de gc eliminar el puerto adquirir el bloqueo\
    \ de gc primero esperar la llamada de bloqueo br_multicasg_gc() adquirir directamente\
    \ el bloqueo ahora pero liberar el puerto el puerto se puede liberar mientras\
    \ los temporizadores de grp a\xFAn se ejecutan Aseg\xFArese de que todos los ciclos\
    \ de gc anteriores hayan finalizado usando flush_work antes de liberar el puerto.\
    \ [1] ERROR: KASAN: slab-use-after-free en br_multicast_port_group_expired+0x4c0/0x550\
    \ net/bridge/br_multicast.c:861 Lectura de tama\xF1o 8 en la direcci\xF3n ffff888071d6d000\
    \ por tarea syz.5.1232/9699 CPU: 1 PID: 9699 Comm : syz.5.1232 No contaminado\
    \ 6.10.0-rc5-syzkaller-00021-g24ca36a562d6 #0 Nombre del hardware: Google Google\
    \ Compute Engine/Google Compute Engine, BIOS Google 07/06/2024 Seguimiento de\
    \ llamadas:  __dump_stack lib/dump_stack.c :88 [en l\xEDnea] dump_stack_lvl+0x116/0x1f0\
    \ lib/dump_stack.c:114 print_address_description mm/kasan/report.c:377 [en l\xED\
    nea] print_report+0xc3/0x620 mm/kasan/report.c:488 kasan_report+0xd9/0x110 mm\
    \ /kasan/report.c:601 br_multicast_port_group_expired+0x4c0/0x550 net/bridge/br_multicast.c:861\
    \ call_timer_fn+0x1a3/0x610 kernel/time/timer.c:1792 expire_timers kernel/time/timer.c:1843\
    \ [en l\xEDnea] __run_timers +0x74b/0xaf0 kernel/time/timer.c:2417 __run_timer_base\
    \ kernel/time/timer.c:2428 [en l\xEDnea] __run_timer_base kernel/time/timer.c:2421\
    \ [en l\xEDnea] run_timer_base+0x111/0x190 kernel/time/timer. c:2437"
id: CVE-2024-44934
lastModified: '2024-08-27T16:07:58.727'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-08-26T11:15:05.593'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0d8b26e10e680c01522d7cc14abe04c3265a928f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1e16828020c674b3be85f52685e8b80f9008f50f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/92c4ee25208d0f35dafc3213cdf355fbe449e078
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b2f794b168cf560682ff976b255aa6d29d14a658
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e3145ca904fa8dbfd1a5bf0187905bc117b0efce
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
