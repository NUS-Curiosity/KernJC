configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ADCC1407-0CB3-4C8F-B4C5-07F682CD7085
      versionEndExcluding: 6.9.9
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
      matchCriteriaId: 2EBB4392-5FA6-4DA9-9772-8F9C750109FA
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
      matchCriteriaId: 331C2F14-12C7-45D5-893D-8C52EE38EA10
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc3:*:*:*:*:*:*
      matchCriteriaId: 3173713D-909A-4DD3-9DD4-1E171EB057EE
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc4:*:*:*:*:*:*
      matchCriteriaId: 79F18AFA-40F7-43F0-BA30-7BDB65F918B9
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc5:*:*:*:*:*:*
      matchCriteriaId: BD973AA4-A789-49BD-8D57-B2846935D3C7
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc6:*:*:*:*:*:*
      matchCriteriaId: 8F3E9E0C-AC3E-4967-AF80-6483E8AB0078
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    btrfs: zoned: fix calc_available_free_space() for zoned mode


    calc_available_free_space() returns the total size of metadata (or

    system) block groups, which can be allocated from unallocated disk

    space. The logic is wrong on zoned mode in two places.


    First, the calculation of data_chunk_size is wrong. We always allocate

    one zone as one chunk, and no partial allocation of a zone. So, we

    should use zone_size (= data_sinfo->chunk_size) as it is.


    Second, the result "avail" may not be zone aligned. Since we always

    allocate one zone as one chunk on zoned mode, returning non-zone size

    aligned bytes will result in less pressure on the async metadata reclaim

    process.


    This is serious for the nearly full state with a large zone size device.

    Allowing over-commit too much will result in less async reclaim work and

    end up in ENOSPC. We can align down to the zone size to avoid that.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: btrfs:zoned:\
    \ fix calc_available_free_space() para el modo zonal calc_available_free_space()\
    \ devuelve el tama\xF1o total de los grupos de bloques de metadatos (o sistema),\
    \ que se pueden asignar desde espacio en disco no asignado. La l\xF3gica es incorrecta\
    \ en el modo por zonas en dos lugares. Primero, el c\xE1lculo de data_chunk_size\
    \ es incorrecto. Siempre asignamos una zona como un fragmento y no asignamos una\
    \ zona parcial. Entonces, deber\xEDamos usar Zone_size (= data_sinfo-&gt;chunk_size)\
    \ tal como est\xE1. En segundo lugar, es posible que el resultado \"avail\" no\
    \ est\xE9 alineado con la zona. Dado que siempre asignamos una zona como un fragmento\
    \ en el modo de zona, devolver bytes alineados sin tama\xF1o de zona generar\xE1\
    \ menos presi\xF3n sobre el proceso de recuperaci\xF3n de metadatos as\xEDncronos.\
    \ Esto es grave para el estado casi lleno con un dispositivo de gran tama\xF1\
    o de zona. Permitir un compromiso excesivo dar\xE1 como resultado menos trabajo\
    \ de recuperaci\xF3n as\xEDncrona y terminar\xE1 en ENOSPC. Podemos alinearnos\
    \ con el tama\xF1o de la zona para evitar eso."
id: CVE-2024-42231
lastModified: '2024-07-30T19:30:52.427'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-30T08:15:08.307'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/64d2c847ba380e07b9072d65a50aa6469d2aa43f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8548903b1999bba02a2b894ad750ab8eb1f40307
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-682
  source: nvd@nist.gov
  type: Primary
