descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    libbpf: Use OPTS_SET() macro in bpf_xdp_query()


    When the feature_flags and xdp_zc_max_segs fields were added to the libbpf

    bpf_xdp_query_opts, the code writing them did not use the OPTS_SET() macro.

    This causes libbpf to write to those fields unconditionally, which means

    that programs compiled against an older version of libbpf (with a smaller

    size of the bpf_xdp_query_opts struct) will have its stack corrupted by

    libbpf writing out of bounds.


    The patch adding the feature_flags field has an early bail out if the

    feature_flags field is not part of the opts struct (via the OPTS_HAS)

    macro, but the patch adding xdp_zc_max_segs does not. For consistency, this

    fix just changes the assignments to both fields to use the OPTS_SET()

    macro.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: libbpf:\
    \ use la macro OPTS_SET() en bpf_xdp_query() Cuando los campos feature_flags y\
    \ xdp_zc_max_segs se agregaron a libbpf bpf_xdp_query_opts, el c\xF3digo que los\
    \ escribi\xF3 no us\xF3 la macro OPTS_SET(). Esto hace que libbpf escriba en esos\
    \ campos incondicionalmente, lo que significa que los programas compilados con\
    \ una versi\xF3n anterior de libbpf (con un tama\xF1o m\xE1s peque\xF1o de la\
    \ estructura bpf_xdp_query_opts) tendr\xE1n su pila da\xF1ada por la escritura\
    \ de libbpf fuera de los l\xEDmites. El parche que agrega el campo feature_flags\
    \ tiene un rescate anticipado si el campo feature_flags no es parte de la estructura\
    \ opts (a trav\xE9s de la macro OPTS_HAS), pero el parche que agrega xdp_zc_max_segs\
    \ no lo hace. Para mantener la coherencia, esta soluci\xF3n simplemente cambia\
    \ las asignaciones a ambos campos para usar la macro OPTS_SET()."
id: CVE-2024-27050
lastModified: '2024-05-01T19:50:25.633'
metrics: {}
published: '2024-05-01T13:15:50.070'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/682ddd62abd4bdcee7584246903e7a2df005fe0d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/92a871ab9fa59a74d013bc04f321026a057618e7
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/cd3be9843247edb8fc6fcd8d8237cbce2bc19f5e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/fa5bef5e80c6a3321b2b1a7070436f3bc5daf07c
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
