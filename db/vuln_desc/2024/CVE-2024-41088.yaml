configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0D1B1C19-B25B-4A8A-904D-D71AC2162CE0
      versionEndExcluding: 6.1.97
      versionStartIncluding: '5.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D72E033B-5323-4C4D-8818-36E1EBC3535F
      versionEndExcluding: 6.6.37
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E95105F2-32E3-4C5F-9D18-7AEFD0E6275C
      versionEndExcluding: 6.9.8
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    can: mcp251xfd: fix infinite loop when xmit fails


    When the mcp251xfd_start_xmit() function fails, the driver stops

    processing messages, and the interrupt routine does not return,

    running indefinitely even after killing the running application.


    Error messages:

    [  441.298819] mcp251xfd spi2.0 can0: ERROR in mcp251xfd_start_xmit: -16

    [  441.306498] mcp251xfd spi2.0 can0: Transmit Event FIFO buffer not empty. (seq=0x000017c7,
    tef_tail=0x000017cf, tef_head=0x000017d0, tx_head=0x000017d3).

    ... and repeat forever.


    The issue can be triggered when multiple devices share the same SPI

    interface. And there is concurrent access to the bus.


    The problem occurs because tx_ring->head increments even if

    mcp251xfd_start_xmit() fails. Consequently, the driver skips one TX

    package while still expecting a response in

    mcp251xfd_handle_tefif_one().


    Resolve the issue by starting a workqueue to write the tx obj

    synchronously if err = -EBUSY. In case of another error, decrement

    tx_ring->head, remove skb from the echo stack, and drop the message.


    [mkl: use more imperative wording in patch description]'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: can:\
    \ mcp251xfd: corrige el bucle infinito cuando falla xmit Cuando falla la funci\xF3\
    n mcp251xfd_start_xmit(), el controlador deja de procesar mensajes y la rutina\
    \ de interrupci\xF3n no regresa, ejecut\xE1ndose indefinidamente incluso despu\xE9\
    s de finalizar el aplicaci\xF3n en ejecuci\xF3n. Mensajes de error: [441.298819]\
    \ mcp251xfd spi2.0 can0: ERROR en mcp251xfd_start_xmit: -16 [441.306498] mcp251xfd\
    \ spi2.0 can0: El b\xFAfer FIFO de evento de transmisi\xF3n no est\xE1 vac\xED\
    o. (seq=0x000017c7, tef_tail=0x000017cf, tef_head=0x000017d0, tx_head=0x000017d3).\
    \ ... y repetir para siempre. El problema puede desencadenarse cuando varios dispositivos\
    \ comparten la misma interfaz SPI. Y hay acceso simult\xE1neo al autob\xFAs. El\
    \ problema ocurre porque tx_ring-&gt;head incrementa incluso si falla mcp251xfd_start_xmit().\
    \ En consecuencia, el controlador omite un paquete TX mientras espera una respuesta\
    \ en mcp251xfd_handle_tefif_one(). Resuelva el problema iniciando una cola de\
    \ trabajo para escribir el obj tx sincr\xF3nicamente si err = -EBUSY. En caso\
    \ de otro error, disminuya tx_ring-&gt;head, elimine skb de la pila de eco y elimine\
    \ el mensaje. [mkl: utilice una redacci\xF3n m\xE1s imperativa en la descripci\xF3\
    n del parche]"
id: CVE-2024-41088
lastModified: '2024-08-22T13:16:08.143'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-29T16:15:04.217'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/3e72558c1711d524e3150103739ddd06650e291b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/6c6b4afa59c2fb4d1759235f866d8caed2aa4729
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d8fb63e46c884c898a38f061c2330f7729e75510
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f926c022ebaabf7963bebf89a97201d66978a025
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-835
  source: nvd@nist.gov
  type: Primary
