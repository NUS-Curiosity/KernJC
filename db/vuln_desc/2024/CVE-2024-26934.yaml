configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C4C98081-1B09-4E13-812A-7CF488B3FE75
      versionEndExcluding: 4.19.312
      versionStartIncluding: '4.4'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 61B524A6-9106-4FE6-A33B-1E4EBCEB56D5
      versionEndExcluding: 5.4.274
      versionStartIncluding: 4.20.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9B023842-6532-401F-9E36-7FB2CA379A45
      versionEndExcluding: 5.10.215
      versionStartIncluding: 5.5.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C82FFB5F-4A2E-49F4-AACE-EC406F625AC3
      versionEndExcluding: 5.15.154
      versionStartIncluding: 5.11.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: C0AC9329-397B-4DA1-963E-935154D84671
      versionEndExcluding: 6.1.84
      versionStartIncluding: 5.16.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D15F9C27-5FEC-4D9D-9C75-6CB330C0B299
      versionEndExcluding: 6.6.24
      versionStartIncluding: 6.2.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0E4663C3-7D71-4DA9-9A13-EC2E448147C0
      versionEndExcluding: 6.7.12
      versionStartIncluding: 6.7.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 57497073-82D5-4695-AA8B-363CA1C033BD
      versionEndExcluding: 6.8.3
      versionStartIncluding: 6.8.0
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.9:r1:*:*:*:*:*:*
      matchCriteriaId: E1E2BC41-356E-412A-9B5D-9B5EFCB4E942
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    USB: core: Fix deadlock in usb_deauthorize_interface()


    Among the attribute file callback routines in

    drivers/usb/core/sysfs.c, the interface_authorized_store() function is

    the only one which acquires a device lock on an ancestor device: It

    calls usb_deauthorize_interface(), which locks the interface''s parent

    USB device.


    The will lead to deadlock if another process already owns that lock

    and tries to remove the interface, whether through a configuration

    change or because the device has been disconnected.  As part of the

    removal procedure, device_del() waits for all ongoing sysfs attribute

    callbacks to complete.  But usb_deauthorize_interface() can''t complete

    until the device lock has been released, and the lock won''t be

    released until the removal has finished.


    The mechanism provided by sysfs to prevent this kind of deadlock is

    to use the sysfs_break_active_protection() function, which tells sysfs

    not to wait for the attribute callback.


    Reported-and-tested by: Yue Sun <samsun1006219@gmail.com>

    Reported by: xingwei lee <xrivendell7@gmail.com>'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: USB:\
    \ core: corrige el punto muerto en usb_deauthorize_interface() Entre las rutinas\
    \ de devoluci\xF3n de llamada de archivos de atributos en drivers/usb/core/sysfs.c,\
    \ la funci\xF3n interface_authorized_store() es la \xFAnica que adquiere un bloqueo\
    \ de dispositivo en un dispositivo antecesor: llama a usb_deauthorize_interface(),\
    \ que bloquea el dispositivo USB principal de la interfaz. Esto conducir\xE1 a\
    \ un punto muerto si otro proceso ya posee ese bloqueo e intenta eliminar la interfaz,\
    \ ya sea mediante un cambio de configuraci\xF3n o porque el dispositivo se ha\
    \ desconectado. Como parte del procedimiento de eliminaci\xF3n, device_del() espera\
    \ a que se completen todas las devoluciones de llamadas de atributos sysfs en\
    \ curso. Pero usb_deauthorize_interface() no se puede completar hasta que se haya\
    \ liberado el bloqueo del dispositivo, y el bloqueo no se liberar\xE1 hasta que\
    \ haya finalizado la eliminaci\xF3n. El mecanismo proporcionado por sysfs para\
    \ evitar este tipo de punto muerto es utilizar la funci\xF3n sysfs_break_active_protection(),\
    \ que le dice a sysfs que no espere la devoluci\xF3n de llamada del atributo.\
    \ Reportado y probado por: Yue Sun  Reportado por: xingwei lee "
id: CVE-2024-26934
lastModified: '2024-06-25T23:15:27.970'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-05-01T06:15:08.090'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/07acf979da33c721357ff27129edf74c23c036c6
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/122a06f1068bf5e39089863f4f60b1f5d4273384
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/12d6a5681a0a5cecc2af7860f0a1613fa7c6e947
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/1b175bc579f46520b11ecda443bcd2ee4904f66a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/80ba43e9f799cbdd83842fc27db667289b3150f5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/8cbdd324b41528994027128207fae8100dff094f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/ab062fa3dc69aea88fe62162c5881ba14b50ecc5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/dbdf66250d2d33e8b27352fcb901de79f3521057
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e451709573f8be904a8a72d0775bf114d7c291d9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-667
  source: nvd@nist.gov
  type: Primary
