descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    drm/amdgpu: Fix buffer size in gfx_v9_4_3_init_ cp_compute_microcode() and rlc_microcode()\n\
    \nThe function gfx_v9_4_3_init_microcode in gfx_v9_4_3.c was generating\nabout\
    \ potential truncation of output when using the snprintf function.\nThe issue\
    \ was due to the size of the buffer 'ucode_prefix' being too\nsmall to accommodate\
    \ the maximum possible length of the string being\nwritten into it.\n\nThe string\
    \ being written is \"amdgpu/%s_mec.bin\" or \"amdgpu/%s_rlc.bin\",\nwhere %s is\
    \ replaced by the value of 'chip_name'. The length of this\nstring without the\
    \ %s is 16 characters. The warning message indicated\nthat 'chip_name' could be\
    \ up to 29 characters long, resulting in a total\nof 45 characters, which exceeds\
    \ the buffer size of 30 characters.\n\nTo resolve this issue, the size of the\
    \ 'ucode_prefix' buffer has been\nreduced from 30 to 15. This ensures that the\
    \ maximum possible length of\nthe string being written into the buffer will not\
    \ exceed its size, thus\npreventing potential buffer overflow and truncation issues.\n\
    \nFixes the below with gcc W=1:\ndrivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c: In function\
    \ \u2018gfx_v9_4_3_early_init\u2019:\ndrivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:379:52:\
    \ warning: \u2018%s\u2019 directive output may be truncated writing up to 29 bytes\
    \ into a region of size 23 [-Wformat-truncation=]\n  379 |         snprintf(fw_name,\
    \ sizeof(fw_name), \"amdgpu/%s_rlc.bin\", chip_name);\n      |               \
    \                                     ^~\n......\n  439 |         r = gfx_v9_4_3_init_rlc_microcode(adev,\
    \ ucode_prefix);\n      |                                                 ~~~~~~~~~~~~\n\
    drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:379:9: note: \u2018snprintf\u2019 output\
    \ between 16 and 45 bytes into a destination of size 30\n  379 |         snprintf(fw_name,\
    \ sizeof(fw_name), \"amdgpu/%s_rlc.bin\", chip_name);\n      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\
    drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:413:52: warning: \u2018%s\u2019 directive\
    \ output may be truncated writing up to 29 bytes into a region of size 23 [-Wformat-truncation=]\n\
    \  413 |         snprintf(fw_name, sizeof(fw_name), \"amdgpu/%s_mec.bin\", chip_name);\n\
    \      |                                                    ^~\n......\n  443\
    \ |         r = gfx_v9_4_3_init_cp_compute_microcode(adev, ucode_prefix);\n  \
    \    |                                                        ~~~~~~~~~~~~\ndrivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:413:9:\
    \ note: \u2018snprintf\u2019 output between 16 and 45 bytes into a destination\
    \ of size 30\n  413 |         snprintf(fw_name, sizeof(fw_name), \"amdgpu/%s_mec.bin\"\
    , chip_name);\n      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: drm/amdgpu:\
    \ corrigi\xF3 el tama\xF1o del b\xFAfer en gfx_v9_4_3_init_ cp_compute_microcode()\
    \ y rlc_microcode() La funci\xF3n gfx_v9_4_3_init_microcode en gfx_v9_4_3.c generaba\
    \ un posible truncamiento de la salida al usar la funci\xF3n snprintf. El problema\
    \ se deb\xEDa a que el tama\xF1o del b\xFAfer 'ucode_prefix' era demasiado peque\xF1\
    o para acomodar la longitud m\xE1xima posible de la cadena que se estaba escribiendo\
    \ en \xE9l. La cadena que se est\xE1 escribiendo es \"amdgpu/%s_mec.bin\" o \"\
    amdgpu/%s_rlc.bin\", donde %s se reemplaza por el valor de 'chip_name'. La longitud\
    \ de esta cadena sin %s es de 16 caracteres. El mensaje de advertencia indicaba\
    \ que 'chip_name' pod\xEDa tener hasta 29 caracteres, lo que daba como resultado\
    \ un total de 45 caracteres, lo que supera el tama\xF1o del b\xFAfer de 30 caracteres.\
    \ Para resolver este problema, el tama\xF1o del b\xFAfer 'ucode_prefix' se ha\
    \ reducido de 30 a 15. Esto garantiza que la longitud m\xE1xima posible de la\
    \ cadena que se escribe en el b\xFAfer no exceder\xE1 su tama\xF1o, evitando as\xED\
    \ posibles problemas de desbordamiento y truncamiento del b\xFAfer. . Corrige\
    \ lo siguiente con gcc W=1: drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c: En funci\xF3\
    n 'gfx_v9_4_3_early_init': drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:379:52: advertencia:\
    \ ' La salida de la directiva de %s puede truncarse escribiendo hasta 29 bytes\
    \ en una regi\xF3n de tama\xF1o 23 [-Wformat-truncation=] 379 | snprintf(fw_name,\
    \ sizeof(fw_name), \"amdgpu/%s_rlc.bin\", chip_name); | ^~ ...... 439 | r = gfx_v9_4_3_init_rlc_microcode(adev,\
    \ ucode_prefix); | ~~~~~~~~~~~~ drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:379:9:\
    \ nota: 'snprintf' genera entre 16 y 45 bytes en un destino de tama\xF1o 30 379\
    \ | snprintf(fw_name, sizeof(fw_name), \"amdgpu/%s_rlc.bin\", chip_name); | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\
    \ ~~~~~~~~~~~~~~~~ drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:413:52: advertencia:\
    \ la salida de la directiva '%s' puede truncarse escribiendo hasta 29 bytes en\
    \ una regi\xF3n de tama\xF1o 23 [-Wformat-truncation=] 413 | snprintf(fw_name,\
    \ sizeof(fw_name), \"amdgpu/%s_mec.bin\", chip_name); | ^~ ...... 443 | r = gfx_v9_4_3_init_cp_compute_microcode(adev,\
    \ ucode_prefix); | ~~~~~~~~~~~~ drivers/gpu/drm/amd/amdgpu/gfx_v9_4_3.c:413:9:\
    \ nota: 'snprintf' genera entre 16 y 45 bytes en un destino de tama\xF1o 30 413\
    \ | snprintf(fw_name, sizeof(fw_name), \"amdgpu/%s_mec.bin\", chip_name); | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\
    \ ~~~~~~~~~~~~~~~~"
id: CVE-2024-39291
lastModified: '2024-06-24T19:26:35.967'
metrics: {}
published: '2024-06-24T14:15:12.863'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/19bd9537b6bc1c882df25206c15917214d8e9460
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/acce6479e30f73ab0872e93a75aed1fb791d04ec
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f1b6a016dfa45cedc080d36fa5d6f22237d80e8b
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Undergoing Analysis
