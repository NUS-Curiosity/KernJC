configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 610CA734-4C6D-43D5-B254-80BB5B7E5098
      versionEndExcluding: 6.6.35
      versionStartIncluding: 6.6.26
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A2E0E6CD-2DC0-4E5C-9037-9A023960B2F9
      versionEndExcluding: 6.9.6
      versionStartIncluding: '6.9'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
      matchCriteriaId: 2EBB4392-5FA6-4DA9-9772-8F9C750109FA
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
      matchCriteriaId: 331C2F14-12C7-45D5-893D-8C52EE38EA10
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    bpf: Fix a potential use-after-free in bpf_link_free()


    After commit 1a80dbcb2dba, bpf_link can be freed by

    link->ops->dealloc_deferred, but the code still tests and uses

    link->ops->dealloc afterward, which leads to a use-after-free as

    reported by syzbot. Actually, one of them should be sufficient, so

    just call one of them instead of both. Also add a WARN_ON() in case

    of any problematic implementation.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: bpf:\
    \ corrige un posible use-after-free en bpf_link_free() Despu\xE9s del commit 1a80dbcb2dba,\
    \ bpf_link se puede liberar mediante link-&gt;ops-&gt;dealloc_deferred, pero el\
    \ c\xF3digo a\xFAn prueba y usa link-&gt;ops-&gt;dealloc despu\xE9s, lo que conduce\
    \ a un use-after-free seg\xFAn lo informado por syzbot. En realidad, uno de ellos\
    \ deber\xEDa ser suficiente, as\xED que llame a uno de ellos en lugar de a ambos.\
    \ Tambi\xE9n agregue WARN_ON() en caso de cualquier implementaci\xF3n problem\xE1\
    tica."
id: CVE-2024-40909
lastModified: '2024-08-29T13:55:21.407'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-07-12T13:15:14.137'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2884dc7d08d98a89d8d65121524bb7533183a63a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/91cff53136daeff50816b0baeafd38a6976f6209
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/fa97b8fed9896f1e89cb657513e483a152d4c382
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
