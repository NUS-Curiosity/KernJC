configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0573E395-3D6E-46EA-B0B9-C915C6EF8375
      versionEndExcluding: 6.1.100
      versionStartIncluding: '4.17'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 96AC42B8-D66D-4AC5-B466-E9BA7910FA29
      versionEndExcluding: 6.6.41
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: AB2E8DEC-CFD5-4C2B-981D-E7E45A36C352
      versionEndExcluding: 6.9.10
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    net, sunrpc: Remap EPERM in case of connection failure in xs_tcp_setup_socket\n\
    \nWhen using a BPF program on kernel_connect(), the call can return -EPERM. This\n\
    causes xs_tcp_setup_socket() to loop forever, filling up the syslog and causing\n\
    the kernel to potentially freeze up.\n\nNeil suggested:\n\n  This will propagate\
    \ -EPERM up into other layers which might not be ready\n  to handle it. It might\
    \ be safer to map EPERM to an error we would be more\n  likely to expect from\
    \ the network system - such as ECONNREFUSED or ENETDOWN.\n\nECONNREFUSED as error\
    \ seems reasonable. For programs setting a different error\ncan be out of reach\
    \ (see handling in 4fbac77d2d09) in particular on kernels\nwhich do not have f10d05966196\
    \ (\"bpf: Make BPF_PROG_RUN_ARRAY return -err\ninstead of allow boolean\"), thus\
    \ given that it is better to simply remap for\nconsistent behavior. UDP does handle\
    \ EPERM in xs_udp_send_request()."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net,\
    \ sunrpc: reasignar EPERM en caso de falla de conexi\xF3n en xs_tcp_setup_socket\
    \ Cuando se usa un programa BPF en kernel_connect(), la llamada puede devolver\
    \ -EPERM. Esto hace que xs_tcp_setup_socket() se repita indefinidamente, llenando\
    \ el syslog y provocando que el kernel se congele potencialmente. Neil sugiri\xF3\
    : Esto propagar\xE1 -EPERM a otras capas que podr\xEDan no estar listas para manejarlo.\
    \ Podr\xEDa ser m\xE1s seguro asignar EPERM a un error que probablemente esperar\xED\
    amos del sistema de red, como ECONNREFUSED o ENETDOWN. ECONNREFUSED como error\
    \ parece razonable. Para los programas, configurar un error diferente puede estar\
    \ fuera de su alcance (consulte el manejo en 4fbac77d2d09), en particular en los\
    \ n\xFAcleos que no tienen f10d05966196 (\"bpf: Make BPF_PROG_RUN_ARRAY return\
    \ -err en lugar de permitir boolean\"), por lo que es mejor simplemente reasignar\
    \ para un comportamiento consistente. UDP maneja EPERM en xs_udp_send_request()."
id: CVE-2024-42246
lastModified: '2024-08-08T14:52:35.353'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-08-07T16:15:47.297'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/626dfed5fa3bfb41e0dffd796032b555b69f9cde
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/d6c686c01c5f12ff8f7264e0ddf71df6cb0d4414
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f2431e7db0fe0daccb2f06bb0d23740affcd2fa6
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/f388cfd913a2b96c05339a335f365795db1b36b6
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-835
  source: nvd@nist.gov
  type: Primary
