configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0AF142DE-E79F-45D3-9418-E0E28BCA1F3E
      versionEndExcluding: 6.9.4
      versionStartIncluding: '4.6'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10.0:rc1:*:*:*:*:*:*
      matchCriteriaId: C40DD2D9-90E3-4E95-9F1A-E7C680F11F2A
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    net: fix __dst_negative_advice() race


    __dst_negative_advice() does not enforce proper RCU rules when

    sk->dst_cache must be cleared, leading to possible UAF.


    RCU rules are that we must first clear sk->sk_dst_cache,

    then call dst_release(old_dst).


    Note that sk_dst_reset(sk) is implementing this protocol correctly,

    while __dst_negative_advice() uses the wrong order.


    Given that ip6_negative_advice() has special logic

    against RTF_CACHE, this means each of the three ->negative_advice()

    existing methods must perform the sk_dst_reset() themselves.


    Note the check against NULL dst is centralized in

    __dst_negative_advice(), there is no need to duplicate

    it in various callbacks.


    Many thanks to Clement Lecigne for tracking this issue.


    This old bug became visible after the blamed commit, using UDP sockets.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: net:\
    \ fix __dst_negative_advice() race __dst_negative_advice() no aplica las reglas\
    \ adecuadas de RCU cuando se debe borrar sk-&gt;dst_cache, lo que genera una posible\
    \ UAF. Las reglas de RCU son que primero debemos borrar sk-&gt;sk_dst_cache y\
    \ luego llamar a dst_release(old_dst). Tenga en cuenta que sk_dst_reset(sk) implementa\
    \ este protocolo correctamente, mientras que __dst_negative_advice() utiliza el\
    \ orden incorrecto. Dado que ip6_negative_advice() tiene una l\xF3gica especial\
    \ contra RTF_CACHE, esto significa que cada uno de los tres -&gt;negative_advice()\
    \ m\xE9todos existentes debe realizar sk_dst_reset() ellos mismos. Tenga en cuenta\
    \ que la verificaci\xF3n de NULL dst est\xE1 centralizada en __dst_negative_advice(),\
    \ no es necesario duplicarla en varias devoluciones de llamada. Muchas gracias\
    \ a Clement Lecigne por dar seguimiento a este problema. Este antiguo error se\
    \ hizo visible despu\xE9s de la confirmaci\xF3n culpada, utilizando sockets UDP."
id: CVE-2024-36971
lastModified: '2024-06-16T13:15:52.820'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-06-10T09:15:09.127'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/051c0bde9f0450a2ec3d62a86d2a0d2fad117f13
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/2295a7ef5c8c49241bff769e7826ef2582e532a6
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/5af198c387128a9d2ddd620b0f0803564a4d4508
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/81dd3c82a456b0015461754be7cb2693991421b4
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/92f1655aa2b2294d0b49925f3b875a634bd3b59e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/b8af8e6118a6605f0e495a58d591ca94a85a50fc
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/db0082825037794c5dba9959c9de13ca34cc5e72
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/eacb8b195579c174a6d3e12a9690b206eb7f28cf
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
