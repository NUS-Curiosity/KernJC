configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: AC0C6E24-8240-425A-BD1A-F78E6D3A67FC
      versionEndExcluding: 6.6.34
      versionStartIncluding: '6.6'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 8366481F-770F-4850-9D0F-2977BD97D5C5
      versionEndExcluding: 6.9.5
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    clk: bcm: rpi: Assign ->num before accessing ->hws\n\nCommit f316cdff8d67 (\"\
    clk: Annotate struct clk_hw_onecell_data with\n__counted_by\") annotated the hws\
    \ member of 'struct clk_hw_onecell_data'\nwith __counted_by, which informs the\
    \ bounds sanitizer about the number\nof elements in hws, so that it can warn when\
    \ hws is accessed out of\nbounds. As noted in that change, the __counted_by member\
    \ must be\ninitialized with the number of elements before the first array access\n\
    happens, otherwise there will be a warning from each access prior to the\ninitialization\
    \ because the number of elements is zero. This occurs in\nraspberrypi_discover_clocks()\
    \ due to ->num being assigned after ->hws\nhas been accessed:\n\n  UBSAN: array-index-out-of-bounds\
    \ in drivers/clk/bcm/clk-raspberrypi.c:374:4\n  index 3 is out of range for type\
    \ 'struct clk_hw *[] __counted_by(num)' (aka 'struct clk_hw *[]')\n\nMove the\
    \ ->num initialization to before the first access of ->hws, which\nclears up the\
    \ warning."
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: clk:\
    \ bcm: rpi: Assign -&gt;num before accessing -&gt;hws Commit f316cdff8d67 (\"\
    clk: Annotate struct clk_hw_onecell_data with __counted_by\") anot\xF3 el miembro\
    \ hws de 'struct clk_hw_onecell_data' con __counted_by, que informa al sanitizante\
    \ de los l\xEDmites sobre la cantidad de elementos en hws, para que pueda advertir\
    \ cuando se accede a hws fuera de los l\xEDmites. Como se se\xF1al\xF3 en ese\
    \ cambio, el miembro __counted_by debe inicializarse con la cantidad de elementos\
    \ antes de que ocurra el primer acceso a la matriz; de lo contrario, habr\xE1\
    \ una advertencia de cada acceso antes de la inicializaci\xF3n porque la cantidad\
    \ de elementos es cero. Esto ocurre en raspberrypi_discover_clocks() debido a\
    \ que -&gt;num se asigna despu\xE9s de que se haya accedido a -&gt;hws: UBSAN:\
    \ array-index-out-of-bounds in drivers/clk/bcm/clk-raspberrypi.c:374:4 index 3\
    \ est\xE1 fuera del rango para el tipo 'struct clk_hw *[] __counted_by(num)' (tambi\xE9\
    n conocido como 'struct clk_hw *[]') Mueva la inicializaci\xF3n -&gt;num antes\
    \ del primer acceso de -&gt;hws, lo que borra la advertencia."
id: CVE-2024-39461
lastModified: '2024-09-03T18:12:22.633'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-06-25T15:15:14.500'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/6dc445c1905096b2ed4db1a84570375b4e00cc0f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/9562dbe5cdbb16ac887d27ef6f179980bb99193c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/cdf9c7871d58d3df59d2775982e3533adb8ec920
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: CWE-129
  source: nvd@nist.gov
  type: Primary
