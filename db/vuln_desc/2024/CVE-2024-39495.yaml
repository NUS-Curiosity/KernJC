configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 5EBA530D-458E-447C-8744-13D4429CCC4A
      versionEndExcluding: 5.4.279
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 659E1520-6345-41AF-B893-A7C0647585A0
      versionEndExcluding: 5.10.221
      versionStartIncluding: '5.5'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 10A39ACC-3005-40E8-875C-98A372D1FFD5
      versionEndExcluding: 5.15.162
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: D435765D-2766-44F5-B319-F713A13E35CE
      versionEndExcluding: 6.1.95
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 6F019D15-84C0-416B-8C57-7F51B68992F0
      versionEndExcluding: 6.6.35
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 0ABBBA1D-F79D-4BDB-AA41-D1EDCC4A6975
      versionEndExcluding: 6.9.6
      versionStartIncluding: '6.7'
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: "In the Linux kernel, the following vulnerability has been resolved:\n\n\
    greybus: Fix use-after-free bug in gb_interface_release due to race condition.\n\
    \nIn gb_interface_create, &intf->mode_switch_completion is bound with\ngb_interface_mode_switch_work.\
    \ Then it will be started by\ngb_interface_request_mode_switch. Here is the relevant\
    \ code.\nif (!queue_work(system_long_wq, &intf->mode_switch_work)) {\n\t...\n\
    }\n\nIf we call gb_interface_release to make cleanup, there may be an\nunfinished\
    \ work. This function will call kfree to free the object\n\"intf\". However, if\
    \ gb_interface_mode_switch_work is scheduled to\nrun after kfree, it may cause\
    \ use-after-free error as\ngb_interface_mode_switch_work will use the object \"\
    intf\".\nThe possible execution flow that may lead to the issue is as follows:\n\
    \nCPU0                            CPU1\n\n                            |   gb_interface_create\n\
    \                            |   gb_interface_request_mode_switch\ngb_interface_release\
    \        |\nkfree(intf) (free)          |\n                            |   gb_interface_mode_switch_work\n\
    \                            |   mutex_lock(&intf->mutex) (use)\n\nFix it by canceling\
    \ the work before kfree."
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: greybus:\
    \ corrigi\xF3 el error de use-after-free en gb_interface_release debido a la condici\xF3\
    n de ejecuci\xF3n. En gb_interface_create, &amp;intf-&gt;mode_switch_completion\
    \ est\xE1 vinculado con gb_interface_mode_switch_work. Luego lo iniciar\xE1 gb_interface_request_mode_switch.\
    \ Aqu\xED est\xE1 el c\xF3digo relevante. if (!queue_work(system_long_wq, &amp;intf-&gt;mode_switch_work))\
    \ { ... } Si llamamos a gb_interface_release para realizar la limpieza, es posible\
    \ que haya un trabajo sin terminar. Esta funci\xF3n llamar\xE1 a kfree para liberar\
    \ el objeto \"intf\". Sin embargo, si gb_interface_mode_switch_work est\xE1 programado\
    \ para ejecutarse despu\xE9s de kfree, puede causar un error de use-after-free\
    \ ya que gb_interface_mode_switch_work usar\xE1 el objeto \"intf\". El posible\
    \ flujo de ejecuci\xF3n que puede provocar el problema es el siguiente: CPU0 CPU1\
    \ | gb_interface_create | gb_interface_request_mode_switch gb_interface_release\
    \ | kfree(intf) (gratis) | | gb_interface_mode_switch_work | mutex_lock(&amp;intf-&gt;mutex)\
    \ (uso) Solucionarlo cancelando el trabajo antes de kfree."
id: CVE-2024-39495
lastModified: '2024-08-20T15:35:19.527'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: 134c704f-9b21-4f2e-91b3-4a467353bcc0
    type: Secondary
published: '2024-07-12T13:15:12.183'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/03ea2b129344152157418929f06726989efc0445
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/0b8fba38bdfb848fac52e71270b2aa3538c996ea
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/2b6bb0b4abfd79b8698ee161bb73c0936a2aaf83
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/5c9c5d7f26acc2c669c1dcf57d1bb43ee99220ce
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/74cd0a421896b2e07eafe7da4275302bfecef201
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/9a733d69a4a59c2d08620e6589d823c24be773dc
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/fb071f5c75d4b1c177824de74ee75f9dd34123b9
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-416
  source: nvd@nist.gov
  type: Primary
- description:
  - lang: en
    value: CWE-416
  source: 134c704f-9b21-4f2e-91b3-4a467353bcc0
  type: Secondary
