configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: FE25FF84-C614-42A2-B1D1-02DDB269B4FC
      versionEndIncluding: 6.9.3
      vulnerable: true
    negate: false
    operator: OR
cveTags: []
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    xfs: fix log recovery buffer allocation for the legacy h_size fixup


    Commit a70f9fe52daa ("xfs: detect and handle invalid iclog size set by

    mkfs") added a fixup for incorrect h_size values used for the initial

    umount record in old xfsprogs versions.  Later commit 0c771b99d6c9

    ("xfs: clean up calculation of LR header blocks") cleaned up the log

    reover buffer calculation, but stoped using the fixed up h_size value

    to size the log recovery buffer, which can lead to an out of bounds

    access when the incorrect h_size does not come from the old mkfs

    tool, but a fuzzer.


    Fix this by open coding xlog_logrec_hblks and taking the fixed h_size

    into account for this calculation.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: xfs:\
    \ corrige la asignaci\xF3n del b\xFAfer de recuperaci\xF3n de registros para la\
    \ correcci\xF3n heredada de h_size. El commit a70f9fe52daa (\"xfs: detecta y maneja\
    \ el tama\xF1o de iclog no v\xE1lido establecido por mkfs\") agreg\xF3 una correcci\xF3\
    n para los valores incorrectos de h_size usados para el registro desmontaje inicial\
    \ en versiones antiguas de xfsprogs. Posteriormente, el commit 0c771b99d6c9 (\"\
    xfs: c\xE1lculo de limpieza de bloques de encabezado LR\") limpi\xF3 el c\xE1\
    lculo del b\xFAfer de recuperaci\xF3n de registros, pero dej\xF3 de usar el valor\
    \ h_size fijo para dimensionar el b\xFAfer de recuperaci\xF3n de registros, lo\
    \ que puede provocar un acceso fuera de los l\xEDmites cuando el h_size incorrecto\
    \ no proviene de la antigua herramienta mkfs, sino de un fuzzer. Solucione este\
    \ problema abriendo la codificaci\xF3n xlog_logrec_hblks y teniendo en cuenta\
    \ el h_size fijo para este c\xE1lculo."
id: CVE-2024-39472
lastModified: '2024-08-19T05:15:06.543'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 5.5
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: NONE
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-07-05T07:15:10.020'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/45cf976008ddef4a9c9a30310c9b4fb2a9a6602a
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/57835c0e7152e36b03875dd6c56dfeed685c1b1f
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c2389c074973aa94e34992e7f66dac0de37595b5
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/f754591b17d0ee91c2b45fe9509d0cdc420527cb
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-770
  source: nvd@nist.gov
  type: Primary
