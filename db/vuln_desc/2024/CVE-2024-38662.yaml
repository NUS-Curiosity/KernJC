configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 5311C980-4CDF-4C10-8875-F04ED0F03398
      versionEndExcluding: 5.10.219
      versionStartIncluding: '5.10'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E2AB5A01-EFFD-4A24-8CCB-4A016C8C4BB3
      versionEndExcluding: 5.15.161
      versionStartIncluding: '5.15'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 7446FC33-DC4F-4D31-94B5-FB577CFA66F4
      versionEndExcluding: 6.1.93
      versionStartIncluding: '6.1'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 53BC60D9-65A5-4D8F-96C8-149F09214DBD
      versionEndExcluding: 6.6.33
      versionStartIncluding: '6.6'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: A500F935-F0ED-4DC7-AD02-9D7C365D13AE
      versionEndExcluding: 6.9.4
      versionStartIncluding: '6.9'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:6.10.0:rc1:*:*:*:*:*:*
      matchCriteriaId: C40DD2D9-90E3-4E95-9F1A-E7C680F11F2A
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    bpf: Allow delete from sockmap/sockhash only if update is allowed


    We have seen an influx of syzkaller reports where a BPF program attached to

    a tracepoint triggers a locking rule violation by performing a map_delete

    on a sockmap/sockhash.


    We don''t intend to support this artificial use scenario. Extend the

    existing verifier allowed-program-type check for updating sockmap/sockhash

    to also cover deleting from a map.


    From now on only BPF programs which were previously allowed to update

    sockmap/sockhash can delete from these map types.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: bpf:\
    \ permitir la eliminaci\xF3n de sockmap/sockhash solo si se permite la actualizaci\xF3\
    n. Hemos visto una afluencia de informes de syzkaller donde un programa BPF adjunto\
    \ a un punto de seguimiento desencadena una violaci\xF3n de la regla de bloqueo\
    \ al realizar un map_delete en un mapa de calcetines/sockhash. No pretendemos\
    \ apoyar este escenario de uso artificial. Ampl\xEDe la verificaci\xF3n de tipo\
    \ de programa permitido del verificador existente para actualizar sockmap/sockhash\
    \ para cubrir tambi\xE9n la eliminaci\xF3n de un mapa. De ahora en adelante, s\xF3\
    lo los programas BPF a los que anteriormente se les permit\xEDa actualizar sockmap/sockhash\
    \ pueden eliminar de estos tipos de mapas."
id: CVE-2024-38662
lastModified: '2024-06-24T18:34:17.547'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: HIGH
      attackVector: LOCAL
      availabilityImpact: NONE
      baseScore: 4.7
      baseSeverity: MEDIUM
      confidentialityImpact: NONE
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
      version: '3.1'
    exploitabilityScore: 1.0
    impactScore: 3.6
    source: nvd@nist.gov
    type: Primary
published: '2024-06-21T12:15:11.180'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/000a65bf1dc04fb2b65e2abf116f0bc0fc2ee7b1
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/11e8ecc5b86037fec43d07b1c162e233e131b1d9
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/29467edc23818dc5a33042ffb4920b49b090e63d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/6693b172f008846811f48a099f33effc26068e1e
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/98e948fb60d41447fd8d2d0c3b8637fc6b6dc26d
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Mailing List
  - Patch
  url: https://git.kernel.org/stable/c/b81e1c5a3c70398cf76631ede63a03616ed1ba3c
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Analyzed
weaknesses:
- description:
  - lang: en
    value: NVD-CWE-noinfo
  source: nvd@nist.gov
  type: Primary
