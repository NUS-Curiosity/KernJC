descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    net: mana: Fix Rx DMA datasize and skb_over_panic


    mana_get_rxbuf_cfg() aligns the RX buffer''s DMA datasize to be

    multiple of 64. So a packet slightly bigger than mtu+14, say 1536,

    can be received and cause skb_over_panic.


    Sample dmesg:

    [ 5325.237162] skbuff: skb_over_panic: text:ffffffffc043277a len:1536 put:1536
    head:ff1100018b517000 data:ff1100018b517100 tail:0x700 end:0x6ea dev:<NULL>

    [ 5325.243689] ------------[ cut here ]------------

    [ 5325.245748] kernel BUG at net/core/skbuff.c:192!

    [ 5325.247838] invalid opcode: 0000 [#1] PREEMPT SMP NOPTI

    [ 5325.258374] RIP: 0010:skb_panic+0x4f/0x60

    [ 5325.302941] Call Trace:

    [ 5325.304389]  <IRQ>

    [ 5325.315794]  ? skb_panic+0x4f/0x60

    [ 5325.317457]  ? asm_exc_invalid_op+0x1f/0x30

    [ 5325.319490]  ? skb_panic+0x4f/0x60

    [ 5325.321161]  skb_put+0x4e/0x50

    [ 5325.322670]  mana_poll+0x6fa/0xb50 [mana]

    [ 5325.324578]  __napi_poll+0x33/0x1e0

    [ 5325.326328]  net_rx_action+0x12e/0x280


    As discussed internally, this alignment is not necessary. To fix

    this bug, remove it from the code. So oversized packets will be

    marked as CQE_RX_TRUNCATED by NIC, and dropped.'
- lang: es
  value: "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net:\
    \ mana: Fix Rx DMA datasize y skb_over_panic mana_get_rxbuf_cfg() alinea el tama\xF1\
    o de datos DMA del buffer RX para que sea m\xFAltiplo de 64. Entonces, un paquete\
    \ ligeramente m\xE1s grande que mtu+14, digamos 1536, se puede recibir y causar\
    \ skb_over_panic. Dmesg de muestra: [5325.237162] skbuff: skb_over_panic: text:ffffffffc043277a\
    \ len:1536 put:1536 head:ff1100018b517000 data:ff1100018b517100 tail:0x700 end:0x6ea\
    \ dev: [ 689] ----------- -[ cortar aqu\xED ]------------ \xA1BUG del kernel [5325.245748]\
    \ en net/core/skbuff.c:192! [ 5325.247838] c\xF3digo de operaci\xF3n no v\xE1\
    lido: 0000 [#1] PREEMPT SMP NOPTI [ 5325.258374] RIP: 0010:skb_panic+0x4f/0x60\
    \ [ 5325.302941] Seguimiento de llamadas: [ 5325.304389]  [ 5325.315794] ? skb_panic+0x4f/0x60\
    \ [5325.317457]? asm_exc_invalid_op+0x1f/0x30 [5325.319490]? skb_panic+0x4f/0x60\
    \ [ 5325.321161] skb_put+0x4e/0x50 [ 5325.322670] mana_poll+0x6fa/0xb50 [mana]\
    \ [ 5325.324578] __napi_poll+0x33/0x1e0 [ 5325.326328 ] net_rx_action+0x12e/0x280\
    \ Como se analiz\xF3 internamente, esta alineaci\xF3n no es necesaria. Para corregir\
    \ este error, elim\xEDnelo del c\xF3digo. Por lo tanto, los paquetes de gran tama\xF1\
    o ser\xE1n marcados como CQE_RX_TRUNCATED por NIC y descartados."
id: CVE-2024-35901
lastModified: '2024-05-20T13:00:04.957'
metrics: {}
published: '2024-05-19T09:15:10.967'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/05cb7c41fa1a7a7b2c2a6b81bbe7c67f5c11932b
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/c0de6ab920aafb56feab56058e46b688e694a246
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://git.kernel.org/stable/c/ca58927b00385005f488b6a9905ced7a4f719aad
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Awaiting Analysis
