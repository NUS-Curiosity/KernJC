configurations:
- nodes:
  - cpeMatch:
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 8046F4BF-7BC0-4D82-8E17-E06BA6DC8E1D
      versionEndExcluding: 5.10.214
      versionStartIncluding: '5.4'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: ACB69438-845D-4E3C-B114-3140611F9C0B
      versionEndExcluding: 5.15.153
      versionStartIncluding: '5.11'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 121A07F6-F505-4C47-86BF-9BB6CC7B6C19
      versionEndExcluding: 6.1.83
      versionStartIncluding: '5.16'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: E00814DC-0BA7-431A-9926-80FEB4A96C68
      versionEndExcluding: 6.6.23
      versionStartIncluding: '6.2'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 9B95D3A6-E162-47D5-ABFC-F3FA74FA7CFD
      versionEndExcluding: 6.7.11
      versionStartIncluding: '6.7'
      vulnerable: true
    - criteria: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
      matchCriteriaId: 543A75FF-25B8-4046-A514-1EA8EDD87AB1
      versionEndExcluding: 6.8.2
      versionStartIncluding: '6.8'
      vulnerable: true
    negate: false
    operator: OR
descriptions:
- lang: en
  value: 'In the Linux kernel, the following vulnerability has been resolved:


    bpf: Fix DEVMAP_HASH overflow check on 32-bit arches


    The devmap code allocates a number hash buckets equal to the next power

    of two of the max_entries value provided when creating the map. When

    rounding up to the next power of two, the 32-bit variable storing the

    number of buckets can overflow, and the code checks for overflow by

    checking if the truncated 32-bit value is equal to 0. However, on 32-bit

    arches the rounding up itself can overflow mid-way through, because it

    ends up doing a left-shift of 32 bits on an unsigned long value. If the

    size of an unsigned long is four bytes, this is undefined behaviour, so

    there is no guarantee that we''ll end up with a nice and tidy 0-value at

    the end.


    Syzbot managed to turn this into a crash on arm32 by creating a

    DEVMAP_HASH with max_entries > 0x80000000 and then trying to update it.

    Fix this by moving the overflow check to before the rounding up

    operation.'
- lang: es
  value: "En el kernel de Linux, se resolvi\xF3 la siguiente vulnerabilidad: bpf:\
    \ corrige la verificaci\xF3n de desbordamiento de DEVMAP_HASH en arcos de 32 bits.\
    \ El c\xF3digo devmap asigna un n\xFAmero de dep\xF3sitos de hash igual a la siguiente\
    \ potencia de dos del valor max_entries proporcionado al crear el mapa. Al redondear\
    \ a la siguiente potencia de dos, la variable de 32 bits que almacena el n\xFA\
    mero de dep\xF3sitos puede desbordarse, y el c\xF3digo verifica el desbordamiento\
    \ comprobando si el valor truncado de 32 bits es igual a 0. Sin embargo, en arcos\
    \ de 32 bits el redondeo hacia arriba puede desbordarse a mitad de camino, porque\
    \ termina haciendo un desplazamiento hacia la izquierda de 32 bits en un valor\
    \ largo sin signo. Si el tama\xF1o de un largo sin firmar es de cuatro bytes,\
    \ este es un comportamiento indefinido, por lo que no hay garant\xEDa de que terminemos\
    \ con un valor 0 agradable y ordenado al final. Syzbot logr\xF3 convertir esto\
    \ en un bloqueo en arm32 creando un DEVMAP_HASH con max_entries &gt; 0x80000000\
    \ y luego intentando actualizarlo. Solucione este problema moviendo la verificaci\xF3\
    n de desbordamiento antes de la operaci\xF3n de redondeo."
id: CVE-2024-26885
lastModified: '2024-06-25T22:15:25.173'
metrics:
  cvssMetricV31:
  - cvssData:
      attackComplexity: LOW
      attackVector: LOCAL
      availabilityImpact: HIGH
      baseScore: 7.8
      baseSeverity: HIGH
      confidentialityImpact: HIGH
      integrityImpact: HIGH
      privilegesRequired: LOW
      scope: UNCHANGED
      userInteraction: NONE
      vectorString: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
      version: '3.1'
    exploitabilityScore: 1.8
    impactScore: 5.9
    source: nvd@nist.gov
    type: Primary
published: '2024-04-17T11:15:10.210'
references:
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/22079b3a423382335f47d9ed32114e6c9fe88d7c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/225da02acdc97af01b6bc6ce1a3e5362bf01d3fb
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/250051acc21f9d4c5c595e4fcb55986ea08c4691
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/281d464a34f540de166cee74b723e97ac2515ec3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/c826502bed93970f2fd488918a7b8d5f1d30e2e3
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/e89386f62ce9a9ab9a94835a9890883c23d9d52c
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  tags:
  - Patch
  url: https://git.kernel.org/stable/c/edf7990baa48de5097daa9ac02e06cb4c798a737
- source: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
  url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
sourceIdentifier: 416baaa9-dc9f-4396-8d5f-8c081fb06d67
vulnStatus: Modified
weaknesses:
- description:
  - lang: en
    value: CWE-119
  source: nvd@nist.gov
  type: Primary
