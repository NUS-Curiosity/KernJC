# BPF Object File (ELF)

This directory contains additional BPF assembly files that can be used to test whether alternative eBPF verifiers (e.g., PREVAIL) are vulnerable to the CVE. This is useful because the PoC directly generates the eBPF bytecode in memory and loads it into the kernel. Therefore, one can not easily get a eBPF object file from the PoC.

`poc.bpf.s` contains the original PoC and should be rejected by the verifier if the verifier is not vulnerable.

To double-check whether `poc.bpf.s` is rejected for the right reasons, you can try loading `poc-pass.bpf.s` which should be accepted by the verifier. `poc-pass.bpf.s` only differs from `poc.bpf.s` in the mis-simulated instruction.

## Example Usage

``` sh
bpf-obj$ make
bpf-obj$ $PREVAIL_DIR/check poc.bpf.o
0,0.0262757,6744 # 0=fail
bpf-obj$ $PREVAIL_DIR/check poc-pass.bpf.o
1,0.0265668,6632 # 1=pass
```

This tells us that this particular [PREVAIL version](https://github.com/vbpf/ebpf-verifier/tree/46344ae4bdc179ebec19edea3ce51d02e8c6d581) is not vulnerable to the CVE.
